{"version":3,"sources":["utils/Imm/withImm.ts","utils/warn.ts","utils/ignore.ts","utils/DefaultProps.ts","components/usePoints/index.tsx","utils/BaseProps.ts","components/Line/index.tsx","utils/evaluate.ts","utils/CustomHooks/useCounter.ts","utils/noop.ts","utils/CustomHooks/useThrottled.ts","utils/CustomHooks/useDataBufferSilent.ts","utils/CustomHooks/useDecay.ts","components/Pusher/index.tsx","components/IVPlot/useDataFeed.ts","components/IVPlot/LOG.tsx","utils/coordinates.ts","utils/clamp.ts","components/IVPlot/useView.ts","components/IVPlot/useLine.ts","utils/identity.ts","utils/diff.ts","components/IVPlot/useTicks.tsx","components/IVPlot/useControls.ts","components/IVPlot/useAnimationFrame.ts","utils/CustomHooks/useSilentCounter.ts","components/IVPlot/useAnimationClock.ts","components/IVPlot/_IVPlot.tsx","utils/throttleEvent.ts","components/Blur/index.tsx","components/IVPlot/index.tsx","components/TitleBar/Wifi.js","components/TitleBar/Time.js","components/TitleBar/lock.svg","components/TitleBar/Login.js","components/TitleBar/index.js","components/CirclePlot/index.tsx","components/Weather/skycons.js","utils/FETCH.js","components/SheetsData/index.js","utils/LOG.js","components/Weather/index.js","App.tsx","serviceWorker.js","index.tsx"],"names":["ignoreUndefined","old","next","undefined","defaultMerger","_old","mergeIntersect","target","_len","arguments","length","sources","Array","_key","mergeIntersectWith","apply","concat","merger","_len2","_key2","selection","Object","keys","filter","Boolean","map","source","key","includes","reduce","obj","objectSpread","defineProperty","mergeWith","toConsumableArray","merge","_len3","_key3","_len4","_key4","_mergeDeepWith","toJS","isMergeable","a","List","isList","_len5","collections","_key5","slice","acc","x","_mergeDeep","b","nextItem","index","existingItem","get","set","fromJS","_len6","_key6","aaaaa","hello","canvasStyle","canvasEffects","bbbbb","poop","process","declare","propsClass","baseClasses","defaults","withImm","base","forEach","warn","types","required","injected","propsIn","propsOut","own","bases","extend","this","factory","props","allOptional","some","c","Wrap","classCallCheck","createClass","value","f","assign","placeholder","rest","wrap","default","optional","decorator","_class","_temp","_class2","_temp2","values","reverse","Points","circleStyle","r","fill","stroke","strokeWidth","textStyle","style","font","labelUnit","_ref","ticks","ticksScale","data","count","curve","scaleY","objectWithoutProperties","react_default","createElement","web","g","_","i","interpolate","tick","y","current","visibility","transform","circle","cx","cy","text","tspan","invert","toFixed","StyleProp","BaseProps","Line","line","clock","theLine","useMemo","expr","context","Function","k","evaluate","d3","path","d","useCounter","initial","_useState","useState","_useState2","slicedToArray","setValue","useCallback","noop","useThrottled","timeout","first","last","inputs","event","useEffect","id","ongoing","handler","clearTimeout","window","setTimeout","addEventListener","removeEventListener","maxSize","Infinity","Args","initialValue","minDelta","maxDelta","halfLife","UpdateArgs","signal","useRef","_ref2","datum","delta","decay","Math","pow","isNaN","pusher","Pusher","config","options","channelIDs","ch","subscribe","CURRENT","min","max","lo","hi","useDataFeed","_x","Date","now","random","samplePeriod","channelName","_useDataBufferSilent","args","_withImm$merge","buffer","Denque","updateBuffer","newData","splice","useDataBufferSilent","_useDataBufferSilent2","append","receiveData","channel","channels","bind","pusherConfig","eventName","_ref3","payload","_console","console","log","LOG","deriveCoordinate","coord","_coord$width","width","w","_coord$height","height","h","clamp","range","_withImm$mergeInterse","_withImm$mergeInterse2","useView","extraHistory","scaleX","_useSpring","useSpring","extent","tension","friction","_useSpring2","currentScaleX","copy","bisector","transformed","domain","_currentScaleX$domain","_currentScaleX$domain2","start","end","history","left","right","padRight","padLeft","view","sort","_ref6","_ref7","useLine","timespan","dims","padDomain","padRange","init","_deriveCoordinates$ca","_ref$x","_ref$y","call","padX","padY","_useView","_useView2","update","identity","arg","diff","convert","useTicks","lineStyle","scale","currentScale","format","tickFormat","span","getTime","every","gap","pad","t","y2","dblclick","useControls","svgRef","baseScale","effect","zoom","scaleExtent","translateExtent","on","rescaleX","duration","paused","at","s","dx","translateBy","clickID","NaN","state","nextState","prevState","from","unpaused","transition","reset","batchMap","Map","silent","interval","batch","useAnimationFrame","_Args","firstTime","error","increment","useSilentCounter","nextFrame","tail","callback","requestAnimationFrame","tracks","isFinite","has","push","size","loop","ts","performance","cancelAnimationFrame","useAnimationClock","FrameArgs","immediate","_IVPlot","channelNames","getBoundingClientRect","volts","amps","updateControls","_useTicks","_useTicks2","Ticks","alpha","Fragment","rect","clipPath","strokeDasharray","strokeDashoffset","defaultArgs","_window","throttle","customEvent","Error","ready","dispatcher","dispatchEvent","CustomEvent","throttler","passive","Props","radius","enabled","Blur","ref","children","document","hidden","div","React","forwardRef","IVPlot","BlurProps","position","borderRadius","backgroundColor","_useCounter","components_Blur","Wifi","bars","display","alignItems","viewBox","Children","e","isValidElement","opacity","level","cloneElement","marginLeft","Time","toLocaleTimeString","_extends","prototype","hasOwnProperty","lock_ref","lock_SvgComponent","__webpack_require__","p","Login","username","TitleBar","URL","location","searchParams","lineHeight","color","justifyContent","paddingLeft","paddingRight","Wifi_Wifi","average","v","CirclePlot","power","voltage","panelIdx","refresh","currentChannel","progress","C","PI","fontFamily","fontSize","textAnchor","alignmentBaseline","dy","module","requestInterval","cancelInterval","raf","caf","fn","handle","setInterval","clearInterval","TAU","TWO_OVER_SQRT_2","sqrt","ctx","ax","ay","bx","by","beginPath","moveTo","lineTo","puff","rx","ry","rmin","rmax","cos","arc","sin","puffs","cloud","cw","fillStyle","globalCompositeOperation","sun","strokeStyle","lineWidth","lineCap","lineJoin","moon","closePath","WIND_PATHS","WIND_OFFSETS","swoosh","total","floor","leaf","Skycons","opts","list","resizeClear","speed","CLEAR_DAY","canvas","CLEAR_NIGHT","PARTLY_CLOUDY_DAY","PARTLY_CLOUDY_NIGHT","CLOUDY","RAIN","rain","SLEET","sleet","SNOW","u","ux","uy","vx","vy","wx","wy","snow","WIND","FOG","fogbank","n","_determineDrawingFunction","draw","toUpperCase","replace","add","el","getElementById","element","getContext","drawing","remove","time","clearRect","play","self","pause","exports","FETCH","asyncToGenerator","regenerator_default","mark","_callee","url","_args","_context","prev","fetch","abrupt","sent","json","stop","href","localStorage","googleKey","join","then","ID","freeze","root","derived","measurements","solcast","spreadsheetId","t0","t1","_callee2","folder","_context2","files","silently","save","retValue","Weather","skycons","temp","descrip","irradiance","status","setStatus","response","_data$properties","properties","textDescription","temperature","currentIcon","LUT","setIcons","fahr","catch","_x2","_mostRecentFile","mostRecentFile","_getRange","getRange","present","find","row","getPeriodEnd","sample","dhi","dni","sunZenith","zenith","sunAzimuth","azimuth","panelArea","derivedConfig","panelTilt","panelAzimuth","_map5","_map6","cosBetaIncident","calculateTotalIrradiance","getIrradiance","dpr","devicePixelRatio","elem","_map","ceil","_map2","bufferW","bufferH","_map3","_map4","newW","newH","sizeCanvas","_useState3","_useState4","setAlpha","_useState5","_useState6","setScale","container","onMouseEnter","onMouseMove","_e$nativeEvent","nativeEvent","clientX","clientY","_elem$getBoundingClie2","top","fromCenter","hypot","toString","padStart","onMouseLeave","padding","background","borderTopRightRadius","borderBottomRightRadius","transformOrigin","overflow","borderTopLeftRadius","borderBottomLeftRadius","flexDirection","textAlign","userSelect","whiteSpace","hour","getHours","daytime","match","test","fields","App","title","reload","M","endOf","msUntilMidnight","components_TitleBar","className","components_CirclePlot","components_IVPlot","hostname","ReactDOM","render","src_App","navigator","serviceWorker","registration","unregister"],"mappings":"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AI6V,EAAIlK,EAAG+G,GACnC9H,GAAK,KAEL,IAAI9Q,EAAS,IAAL+b,EAAgB,GAAJlK,EAClBnR,EAAS,IAALqb,EACJhZ,EAAI6G,KAAK8R,IAAI5K,EAAI4J,GACjBtC,EAAKrV,EAAI2X,GAAQ,GAEnBG,EAAIsB,YAAcvD,EAClBiC,EAAIuB,UAAYvK,EAChBgJ,EAAIwB,QAAU,QACdxB,EAAIyB,SAAW,QAEfrW,GAAMlD,EAAIrC,EAEVma,EAAIK,YACJL,EAAIc,IAAI1V,EAAIC,EAAIlG,EAAGoY,EAAIsC,EAAM,EAAGtC,EAAW,EAANsC,EAAW,GAAG,GACnDG,EAAIc,IACF1V,EAAK2D,KAAK8R,IAAItD,GAAKpY,EAAI2a,EACvBzU,EAAK0D,KAAKgS,IAAIxD,GAAKpY,EAAI2a,EACvB3a,EACAoY,EAAW,EAANsC,EAAW,EAChBtC,EAAW,EAANsC,EAAW,GAChB,GAEFG,EAAI2B,YACJ3B,EAAIvW,SAsIN,IAAImY,EAAa,CACb,EACG,KACA,KACA,OACA,OACA,OACA,OACA,OACA,MACA,OACA,OACA,OACA,OACA,MACD,OACC,MACD,OACC,MACD,OACC,MACD,OACC,MACD,OACC,MACD,OACC,MACD,OACC,MACD,MACC,MACD,OACC,MACD,OACC,MACD,OACC,MACD,OACC,MACD,OACC,IACD,OACC,KACD,OACC,MACD,OACC,MACD,OACC,OACA,MACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,MACA,OACA,OACA,OACA,MACA,OACA,MACD,OACC,MACD,OACC,MACD,OACC,KACD,OACC,MACD,OACC,MACD,OACC,MACD,MACA,MACA,KACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,IACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,KACA,MACA,MACA,MACA,MACA,MACA,KACA,MACA,KACA,IACA,KA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","file":"static/js/main.5a0c4d6c.chunk.js","sourcesContent":["import { List, fromJS } from 'immutable';\r\nimport { ArrayToIntersectionNonNull } from 'utils/meta';\r\n\r\n// Useful merger to ignore undefined\r\n// Another difference: The merged result excludes properties not originally present in `target`\r\nexport function ignoreUndefined<V>(old: V, next: V) {\r\n  return next === undefined ? old : next;\r\n}\r\n\r\nexport function defaultMerger<V>(_old: V, next: V) {\r\n  return next;\r\n}\r\n\r\n// Like `Object.assign` but properties are merged deeply. Sources are copied not modified. Does not preserve reference equality for Immutable objects because the result is converted to a POJ. Use `_mergeDeep` to get an Immutable object back. Passing no sources will yield an empty object {}. Undefined values in `sources` are ignored (do not overwrite values in first source). Only considers own properties of objects (not properties inherited in their prototypes). Does not add new properties not originally in `target`.\r\nexport function mergeIntersect<T extends object, S extends any[]>(\r\n  target: T,\r\n  ...sources: S\r\n) {\r\n  return mergeIntersectWith(ignoreUndefined, target, ...sources) as T;\r\n}\r\n\r\n// Same as `mergeIntersect` but properties are merged deeply using the custom merge conflict resolver passed.\r\nexport function mergeIntersectWith<T extends object, S extends any[]>(\r\n  merger: <K, V>(old: V, next: V, key: K) => V,\r\n  target: T,\r\n  ...sources: S\r\n) {\r\n  // Filter out props not already present in `target`.\r\n  const selection = Object.keys(target);\r\n  sources = sources.filter(Boolean).map(source =>\r\n    // Special case for Array objects (preserve its prototype)\r\n    source instanceof Array\r\n      ? source\r\n      : Object.keys(source)\r\n          .filter(key => selection.includes(key))\r\n          .reduce((obj, key) => {\r\n            return {\r\n              ...obj,\r\n              [key]: (source as any)[key],\r\n            };\r\n          }, {})\r\n  ) as S;\r\n  return mergeWith(merger, target, ...sources) as T;\r\n}\r\n\r\n// Like `Object.assign` but properties are merged deeply. Sources are copied not modified. Does not preserve reference equality for Immutable objects because the result is converted to a POJ. Use `_mergeDeep` to get an Immutable object back. Passing no sources will yield an empty object {}. Undefined values in `sources` are ignored (do not overwrite values in first source). Only considers own properties of objects (not properties inherited in their prototypes).\r\n// Note: For some reason TypeScript doesn't recognize if you call merge() with both spread and individual arguments.\r\n// For instance `merge(...args, defaultSettings)` does not work!\r\n// My signature is probably at fault but I don't know how to fix it. (2/23/19)\r\nexport function merge<T extends any[]>(...sources: T) {\r\n  return mergeWith(ignoreUndefined, ...sources) as {\r\n    [K in keyof ArrayToIntersectionNonNull<T>]: ArrayToIntersectionNonNull<T>[K]\r\n  };\r\n}\r\n\r\n// Same as `merge` but properties are merged deeply using the custom merge conflict resolver passed.\r\nexport function mergeWith<T extends any[]>(\r\n  merger: <K, V>(old: V, next: V, key: K) => V,\r\n  ...sources: T\r\n) {\r\n  return _mergeDeepWith(merger, ...sources).toJS() as {\r\n    [K in keyof ArrayToIntersectionNonNull<T>]: ArrayToIntersectionNonNull<T>[K]\r\n  };\r\n}\r\n\r\nfunction isMergeable(a: any): a is { mergeWith: Function } {\r\n  return (\r\n    a &&\r\n    typeof a === 'object' &&\r\n    typeof a.mergeWith === 'function' &&\r\n    !List.isList(a)\r\n  );\r\n}\r\n\r\ntype Merger = <K, V>(oldVal: V, newVal: V, key?: K) => V;\r\nexport function _mergeDeepWith<T extends object[]>(\r\n  merger: Merger,\r\n  ...collections: T\r\n) {\r\n  /* \r\n  https://github.com/immutable-js/immutable-js/issues/1452#issuecomment-386162309\r\n  */\r\n  const _mergeDeep = <K, V>(a: V, b: V, key?: K): V | List<unknown> => {\r\n    // If b is null, it would overwrite a, even if a is mergeable\r\n    if (isMergeable(a) && b !== null) {\r\n      return a.mergeWith(_mergeDeep, b);\r\n    }\r\n\r\n    if (!List.isList(a) || !List.isList(b)) {\r\n      return merger(a, b, key);\r\n    }\r\n\r\n    return (b as List<unknown>).reduce(\r\n      (acc, nextItem, index) => {\r\n        const existingItem = acc.get(index);\r\n        if (isMergeable(existingItem)) {\r\n          return acc.set(index, existingItem.mergeWith(_mergeDeep, nextItem));\r\n        }\r\n\r\n        return acc.set(index, merger(existingItem, nextItem, index));\r\n      },\r\n      a as List<unknown>\r\n    );\r\n  };\r\n\r\n  return collections\r\n    .slice(1)\r\n    .reduce(\r\n      (acc, x) => _mergeDeep(acc, fromJS(x)),\r\n      fromJS(collections[0] != null ? collections[0] : {})\r\n    );\r\n}\r\n\r\nexport function _mergeDeep<T extends object[]>(...collections: T) {\r\n  return _mergeDeepWith(defaultMerger, ...collections);\r\n}\r\n\r\n// Example use:\r\nconst aaaaa = { hello: 3, canvasStyle: [1, 2, 3], canvasEffects: () => {} };\r\nconst bbbbb = { hello: 'world', canvasStyle: [3, , 1], poop: 'hiii' };\r\nconst ccccc = merge(aaaaa, bbbbb);\r\nconst ddddd = merge(...([aaaaa, bbbbb] as [typeof aaaaa, typeof bbbbb]));\r\n// const ccccc = merge();\r\n// console.log(ccccc);\r\n\r\n// Object.assign(window, {\r\n//   List,\r\n//   fromJS,\r\n//   _mergeDeepWith,\r\n//   _mergeDeep,\r\n//   merge,\r\n//   aaaaa,\r\n//   bbbbb,\r\n//   ccccc,\r\n// });\r\n","import ignore from './ignore';\r\n\r\nexport default (process.env.NODE_ENV === 'development' ? console.warn : ignore);\r\n","const ignore = (..._args: any[]) => {};\r\nexport default ignore;\r\n","import {\r\n  Omit,\r\n  Equals,\r\n  RequiredOnly,\r\n  ArrayToIntersectionNonNull,\r\n  RecursivePartial,\r\n} from './meta';\r\nimport * as withImm from './Imm/withImm';\r\nimport warn from './warn';\r\n\r\nexport type PropsClass = {\r\n  required?: object;\r\n  defaults?: object;\r\n  injected?: object;\r\n};\r\n\r\ntype Mix<T> = Pick<T, keyof T>;\r\n\r\n// Returns a factory that applies default props to props\r\nexport function declare<P extends PropsClass, S extends PropsClass[]>(\r\n  propsClass: P,\r\n  ...baseClasses: S\r\n) {\r\n  type R = P['required'] & {};\r\n  type D = P['defaults'] & {};\r\n  type I = P['injected'] & {};\r\n\r\n  type BasesR<T> = T extends PropsClass ? T['required'] : {};\r\n  type BasesD<T> = T extends PropsClass ? T['defaults'] : {};\r\n  type BasesI<T> = T extends PropsClass ? T['injected'] : {};\r\n  type BaseClasses = ArrayToIntersectionNonNull<S>;\r\n\r\n  // Properties in `propsClass.defaults` will make inherited properties with the same name optional, but will not affect properties in `propsClass.required`.\r\n  type Defaults = Mix<D & BasesD<BaseClasses>>;\r\n  type Required = Mix<R & Omit<BasesR<BaseClasses>, keyof Defaults>>;\r\n  type Injected = Mix<I & BasesI<BaseClasses>>;\r\n\r\n  // External-facing props interface\r\n  type PropsIn = Mix<\r\n    Required & RecursivePartial<Defaults> & RecursivePartial<Injected>\r\n  >;\r\n  // Internal-facing props interface\r\n  type PropsOut = Mix<Required & Defaults & Injected>;\r\n\r\n  const defaults = withImm.merge(\r\n    ...baseClasses.map(base => base.defaults),\r\n    propsClass.defaults as D\r\n  ) as Defaults;\r\n\r\n  // Warn about bad behavior with React refs\r\n  Object.keys(defaults).forEach(key => {\r\n    if (key === 'children') {\r\n      warn(`Don't use a default children prop! Refs will be lost.`);\r\n    } else if (\r\n      typeof defaults[key as keyof Defaults] === 'object' &&\r\n      'current' in defaults[key as keyof Defaults]\r\n    ) {\r\n      warn(\r\n        `Found an default property with a 'current' property. If this is a 'React.RefObject' beware that the ref may be lost! ${key}:`,\r\n        defaults[key as keyof Defaults]\r\n      );\r\n    }\r\n  });\r\n\r\n  type Me = { required: Required; defaults: Defaults; injected: Injected };\r\n\r\n  function extend<T extends PropsClass, U extends PropsClass[]>(\r\n    this: Me,\r\n    propsClass: T,\r\n    ...baseClasses: U\r\n  ) {\r\n    // Need to phrase it like this for type inference...\r\n    return declare(propsClass, declare(this, ...baseClasses));\r\n  }\r\n\r\n  const types = {\r\n    // Default arguments\r\n    defaults: defaults as { [K in keyof Defaults]: Defaults[K] },\r\n    // Required arguments\r\n    required: {} as { [K in keyof Required]: Required[K] },\r\n    // Values supplied not at the call site\r\n    injected: {} as { [K in keyof Injected]: Injected[K] },\r\n    // External-facing props interface (type)\r\n    propsIn: {} as { [K in keyof PropsIn]: PropsIn[K] },\r\n    // Internal-facing props interface (type)\r\n    propsOut: {} as { [K in keyof PropsOut]: PropsOut[K] },\r\n    // Class with my own required and defaults, discounting inherited properties\r\n    own: propsClass as { [K in keyof PropsClass]-?: P[K] & {} },\r\n    // List of base classes (filtered to just show their PropsClass fields)\r\n    bases: (baseClasses as unknown) as {\r\n      [K in keyof S]: S[K] extends PropsClass\r\n        ? { [L in keyof PropsClass]-?: S[K][L] }\r\n        : S[K]\r\n    },\r\n    // Shortcut to declare() with this DefaultProps object as the baseClass\r\n    extend,\r\n  };\r\n\r\n  // Type expanded inline for better tooltip\r\n  type Factory = (\r\n    props: { [K in keyof PropsIn]: PropsIn[K] }\r\n  ) => { [K in keyof PropsOut]: PropsOut[K] };\r\n\r\n  const factory: Factory = props => {\r\n    return {\r\n      ...props,\r\n      ...withImm.mergeIntersect(defaults, props),\r\n    } as ReturnType<Factory>;\r\n  };\r\n\r\n  // Runtime check for whether all props specified are optional (defaults or injected)\r\n  const allOptional = ![propsClass, ...baseClasses].some(c => 'required' in c);\r\n\r\n  type Decorated<T> = <U extends any[], V>(\r\n    props: PropsIn,\r\n    placeholder?: V,\r\n    ...rest: U\r\n  ) => T extends (...args: any[]) => infer W ? W : any;\r\n\r\n  type DecoratedOptional<T> = <U extends any[], V>(\r\n    props?: PropsIn,\r\n    placeholder?: V,\r\n    ...rest: U\r\n  ) => T extends (...args: any[]) => infer W ? W : any;\r\n\r\n  type AcceptsPropsOut = (props: PropsOut, ...rest: any[]) => any;\r\n\r\n  class Wrap {\r\n    // Decorator accepting a function whose props are to be transformed\r\n    static default<T extends AcceptsPropsOut>(f: T) {\r\n      const decorated: Decorated<T> = (props, placeholder, ...rest) => {\r\n        return f(\r\n          factory(props as Parameters<Factory>[0]),\r\n          placeholder,\r\n          ...rest\r\n        );\r\n      };\r\n\r\n      return Object.assign(decorated, types, { wrap: Wrap.default });\r\n    }\r\n\r\n    // Decorator accepting a function whose props are to be transformed where the props argument is optional.\r\n    static optional<T extends AcceptsPropsOut>(f: T) {\r\n      const decorated: DecoratedOptional<T> = (props, placeholder, ...rest) => {\r\n        return f(\r\n          factory(props as Parameters<Factory>[0]),\r\n          placeholder,\r\n          ...rest\r\n        );\r\n      };\r\n\r\n      return Object.assign(decorated, types, { wrap: Wrap.optional });\r\n    }\r\n\r\n    // Select which Wrap signature to use depending on allOptional\r\n    static decorator = (allOptional ? Wrap.optional : Wrap.default) as Equals<\r\n      RequiredOnly<Required>,\r\n      {},\r\n      typeof Wrap.optional,\r\n      typeof Wrap.default\r\n    >;\r\n  }\r\n\r\n  return Object.assign(factory, types, { wrap: Wrap['decorator'] });\r\n}\r\n\r\nexport function required<T extends object, S extends object[] = []>(\r\n  ..._others: S\r\n) {\r\n  type Others = ArrayToIntersectionNonNull<S>;\r\n  return declare(\r\n    class {\r\n      static required: T & Others;\r\n    }\r\n  );\r\n}\r\n\r\n// Arguments are deeply merged in reverse order.\r\nexport function defaults<T extends object[]>(...values: T) {\r\n  return declare(\r\n    class {\r\n      static defaults = withImm.merge(...(values.reverse() as T));\r\n    }\r\n  );\r\n}\r\n\r\nexport function injected<T extends object, S extends object[] = []>(\r\n  ..._others: S\r\n) {\r\n  type Others = ArrayToIntersectionNonNull<S>;\r\n  return declare(\r\n    class {\r\n      static injected: T & Others;\r\n    }\r\n  );\r\n}\r\n\r\n// Test usage:\r\n// import React from 'react';\r\n// import { GoodCanvasElement } from 'components/GoodCanvas';\r\n// import { BaseProps } from 'utils/BaseProps';\r\n// import noop from 'utils/noop';\r\n// class Props {\r\n//   static required: {\r\n//     canvasRef: React.RefObject<GoodCanvasElement> | 5;\r\n//     // canvasStyle: number;\r\n//   };\r\n//   static defaults = {\r\n//     // canvasStyle: {},\r\n//     canvasEffects: noop,\r\n//     canvasNeedsUpdate: 0,\r\n//   };\r\n// }\r\n\r\n// class PropsB {\r\n//   static required: {\r\n//     canvasRef: React.RefObject<GoodCanvasElement> | 5;\r\n//     canvasStyle: { hi: number }; // required if not parent\r\n//   };\r\n//   static defaults = {\r\n//     canvasStyle: {}, // only applied on inheritance\r\n//     canvasEffects: noop,\r\n//     canvasNeedsUpdate: 0,\r\n//   };\r\n// }\r\n\r\n// const a = bind(\r\n//   Props,\r\n//   // [1, 2],\r\n//   // withDefault(Props),\r\n//   // { hi: 'world', defaults: { ddd: 4 }, required: { hello: 'world' } },\r\n//   PropsB\r\n// );\r\n// const c = a.required;\r\n// const d = a.defaults;\r\n// const e = a.own.required;\r\n// const f = a.own.defaults;\r\n// const g = a.bases;\r\n// const h = a.propsIn;\r\n// const i = a.propsOut;\r\n// const j = a.decorate;\r\n// const b = a({ canvasRef: 5, canvasNeedsUpdate: 3 });\r\n// type DefaultProps = Pick<typeof b, keyof typeof b>;\r\n","import React from 'react';\r\nimport { Pair } from 'utils/Pair';\r\nimport { defaults, required, declare } from 'utils/DefaultProps';\r\nimport { REF } from 'utils/easier';\r\nimport { animated, OpaqueInterpolation, interpolate } from 'react-spring';\r\nimport { SVGAttributes } from 'react';\r\nimport { Animatable } from 'react-spring/renderprops';\r\n\r\nexport const Args = declare(\r\n  required<{\r\n    data: REF<Pair[]>;\r\n    ticks: OpaqueInterpolation<Date[]>;\r\n    ticksScale: d3.ScaleTime<number, number>;\r\n    scaleY: d3.ScaleLinear<number, number>;\r\n    curve: d3.CurveCatmullRomFactory;\r\n    count: number;\r\n  }>(),\r\n  defaults({\r\n    circleStyle: {\r\n      r: 3,\r\n      fill: 'hsl(330, 100%, 75%)',\r\n      stroke: 'hsl(330, 100%, 50%)',\r\n      strokeWidth: 0.5,\r\n    } as Animatable<SVGAttributes<SVGCircleElement>>,\r\n    textStyle: {\r\n      fill: 'hsl(330, 100%, 75%)',\r\n      style: {\r\n        font: '16px ubuntu mono, monospace',\r\n      },\r\n    } as Animatable<SVGAttributes<SVGTextElement>>,\r\n    labelUnit: '',\r\n  }),\r\n  required<Animatable<SVGAttributes<SVGGElement>>>()\r\n);\r\n\r\n/* \r\n{\r\noffsetX: 0,\r\noffsetY: 0,\r\nblurRadius: 5,\r\nspreadRadius: 0.5,\r\n// use alpha = 0.5 for light-mode\r\ncolor: 'hsl(330, 100%, 50%)',\r\n}\r\n*/\r\nexport const Points = Args.wrap(\r\n  ({\r\n    ticks,\r\n    ticksScale,\r\n    data,\r\n    count,\r\n    curve,\r\n    scaleY,\r\n    circleStyle,\r\n    textStyle,\r\n    labelUnit,\r\n    ...rest\r\n  }) => (\r\n    <animated.g {...rest}>\r\n      {[...Array(count)].map((_, i) => {\r\n        // console.log('hiiii', i);\r\n        const tick = ticks.interpolate<Date | 0>(ticks => ticks[i] || 0);\r\n        const x = tick.interpolate(tick => ticksScale(tick));\r\n        const y = x.interpolate(x =>\r\n          x !== 0 && data.current.length\r\n            ? curve.interpolate(x, data.current) || -1\r\n            : -1\r\n        );\r\n        const visibility = y.interpolate<string>(y =>\r\n          y !== -1 ? 'visible' : 'hidden'\r\n        );\r\n\r\n        return (\r\n          <animated.g\r\n            key={i}\r\n            visibility={visibility}\r\n            transform={interpolate([x, y], (x, y) => `translate(${x},${y})`)}\r\n          >\r\n            <animated.circle cx={0} cy={0} {...circleStyle} />\r\n            <animated.text x={5} y={4} {...textStyle}>\r\n              <animated.tspan>\r\n                {y.interpolate(y => scaleY.invert(y).toFixed(1))}\r\n              </animated.tspan>\r\n              <tspan>{labelUnit && labelUnit}</tspan>\r\n            </animated.text>\r\n          </animated.g>\r\n        );\r\n      })}\r\n    </animated.g>\r\n  )\r\n);\r\n","import React from 'react';\r\nimport { declare, required, defaults } from './DefaultProps';\r\n\r\nexport const StyleProp = defaults({\r\n  style: {} as Partial<React.CSSProperties>,\r\n});\r\n\r\n// https://github.com/sw-yx/react-typescript-cheatsheet#useful-react-prop-type-examples\r\nexport const BaseProps = declare(\r\n  required<{\r\n    /* 1/9/19: SIGH. TypeScript can't check `children` because `React.createElement` returns back a super general `Element` type. */\r\n    children?: React.ReactNode;\r\n    onChange?: (e: React.FormEvent<HTMLInputElement>) => void;\r\n  }>(),\r\n  StyleProp\r\n);\r\n","import React, { useMemo, SVGAttributes } from 'react';\r\nimport * as d3 from 'd3';\r\nimport { Pair } from 'utils/Pair';\r\nimport { evaluate } from 'utils/evaluate';\r\nimport { required, defaults, declare } from 'utils/DefaultProps';\r\nimport { animated, OpaqueInterpolation } from 'react-spring';\r\nimport { BaseProps } from 'utils/BaseProps';\r\nimport { REF } from 'utils/easier';\r\nimport { Animatable } from 'react-spring/renderprops';\r\n\r\nexport const Args = declare(\r\n  required<{ data: REF<Pair[]>; clock: OpaqueInterpolation<number> }>(),\r\n  defaults({\r\n    // alpha = 0.5 gives centripetal CatmullRom\r\n    line: 'd3.line().curve(d3.curveCatmullRom.alpha(0.5))' as\r\n      | d3.Line<Pair>\r\n      | string,\r\n  }),\r\n  defaults({\r\n    fill: 'transparent',\r\n    stroke: 'hsl(330, 100%, 67%)',\r\n    strokeWidth: 1.5,\r\n  } as Animatable<SVGAttributes<SVGPathElement>>),\r\n  BaseProps\r\n);\r\n\r\nexport const Line = Args.wrap(({ data, clock, line, ...rest }) => {\r\n  const theLine = useMemo(\r\n    () =>\r\n      (typeof line === 'string' ? evaluate(line, { d3 }) : line) as d3.Line<\r\n        Pair\r\n      >,\r\n    [line]\r\n  );\r\n\r\n  return (\r\n    <animated.path\r\n      d={clock.interpolate(() => theLine(data.current) || 'M0,0')}\r\n      {...rest}\r\n    />\r\n  );\r\n});\r\n","export const evaluate = (expr: string, context: any = {}) =>\r\n  Function(...Object.keys(context), `'use strict';return ${expr}`)(\r\n    ...Object.keys(context).map(k => context[k])\r\n  );\r\n","import { useState, useCallback } from 'react';\r\n\r\nexport function useCounter(initial: number = 0): [number, () => void] {\r\n  const [value, setValue] = useState(initial);\r\n  const increment = useCallback(() => setValue(i => i + 1), []);\r\n  return [value, increment];\r\n}\r\n","const noop = () => {};\r\nexport default noop;\r\n","import React, { useEffect } from 'react';\r\nimport noop from 'utils/noop';\r\nimport { declare, required, defaults } from 'utils/DefaultProps';\r\n\r\nconst Args = declare(\r\n  required<{ event: string }>(),\r\n  defaults({\r\n    timeout: 250,\r\n    first: noop,\r\n    last: noop,\r\n  })\r\n);\r\n\r\nexport const useThrottled = Args.wrap(\r\n  ({ event, first, last, timeout }, inputs?: React.InputIdentityList) => {\r\n    useEffect(() => {\r\n      if (!event) return;\r\n\r\n      let ongoing = false;\r\n      let id: number;\r\n\r\n      const handler = () => {\r\n        // first resize event\r\n        if (!ongoing) {\r\n          if (first) first();\r\n          ongoing = true;\r\n        }\r\n\r\n        // dismiss pending events\r\n        if (id) clearTimeout(id);\r\n\r\n        // fulfill last response after timeout\r\n        id = window.setTimeout(() => {\r\n          ongoing = false;\r\n          if (last) last();\r\n        }, timeout);\r\n      };\r\n\r\n      window.addEventListener(event, handler);\r\n      return () => window.removeEventListener(event, handler);\r\n    }, inputs);\r\n  }\r\n);\r\n","import { useMemo } from 'react';\r\nimport { withImm } from 'utils/Imm';\r\nimport Denque from 'denque';\r\n\r\nconst defaults = {\r\n  maxSize: Infinity,\r\n};\r\n\r\ninterface Args<T> extends Partial<typeof defaults> {\r\n  initialValue?: T[];\r\n}\r\n\r\nexport function useDataBufferSilent<T = number, U extends Array<T> = T[]>(\r\n  args: Args<T>\r\n): [Denque<T>, (...newData: U) => void] {\r\n  const { initialValue, maxSize } = withImm.merge(defaults, args);\r\n  const buffer = useMemo(\r\n    () => (initialValue ? new Denque<T>(initialValue) : new Denque<T>()),\r\n    []\r\n  );\r\n  const updateBuffer = useMemo(\r\n    () => (...newData: U) => {\r\n      buffer.splice(buffer.length, 0, ...newData);\r\n      if (buffer.length > maxSize!) {\r\n        buffer.splice(0, buffer.length - maxSize!);\r\n      }\r\n    },\r\n    []\r\n  );\r\n  return [buffer, updateBuffer];\r\n}\r\n","import { useRef } from 'react';\r\nimport warn from 'utils/warn';\r\nimport { defaults, required } from 'utils/DefaultProps';\r\n\r\nconst Args = defaults({\r\n  initialValue: 0,\r\n  minDelta: 10, // ms\r\n  maxDelta: Infinity, // ms\r\n  halfLife: 250, // ms\r\n});\r\n\r\nconst UpdateArgs = required<{\r\n  datum: number;\r\n  delta: number; // ms\r\n}>();\r\n\r\nexport const useDecay = Args.wrap(\r\n  ({ initialValue, minDelta, maxDelta, halfLife }) => {\r\n    const signal = useRef(initialValue);\r\n\r\n    const update = UpdateArgs.wrap(({ datum, delta }) => {\r\n      const decay = Math.pow(0.5, delta / halfLife);\r\n      if (delta < minDelta) {\r\n      } else if (delta > maxDelta) signal.current = 1000 / delta;\r\n      else signal.current = decay * signal.current + (1 - decay) * datum;\r\n      if (isNaN(signal.current)) {\r\n        warn('Signal was NaN...');\r\n        signal.current = 0;\r\n      }\r\n      return signal.current;\r\n    });\r\n\r\n    return update;\r\n  }\r\n);\r\n","import Pusher from 'pusher-js';\r\nimport config from './pusher.config.json';\r\n\r\nconst pusher = new Pusher(config.key, config.options);\r\n\r\nconfig.channelIDs.forEach(ch => {\r\n  pusher.subscribe(ch);\r\n});\r\n\r\nexport default pusher;\r\n","import { useEffect } from 'react';\r\nimport { Pair } from 'utils/Pair';\r\nimport { useDataBufferSilent } from 'utils/CustomHooks';\r\nimport { declare, required, defaults } from 'utils/DefaultProps';\r\nimport pusher from 'components/Pusher';\r\nimport pusherConfig from 'components/Pusher/pusher.config.json';\r\nimport { LOG } from './LOG';\r\n\r\nconst CURRENT = [3.1, 3.2, 2.1, 2.0, 2.9, 1.8, 4.5, 4.2];\r\nconst [lo, hi] = [Math.min(...CURRENT), Math.max(...CURRENT)];\r\nconst generate = (): Pair => [Date.now(), Math.random() * (hi - lo) + lo];\r\nconst _initialValue = [...Array(100)].map((_x, i) => [\r\n  Date.now() + ((100 - 1 - i) / 100) * -10000,\r\n  Math.random() * (hi - lo) + lo,\r\n]);\r\n\r\nconst Args = declare(\r\n  required<{\r\n    samplePeriod: number; // ms\r\n    channelName: string;\r\n  }>(),\r\n  defaults({\r\n    maxSize: 100,\r\n    initialValue: [] as Pair[],\r\n  })\r\n);\r\n\r\nexport const useDataFeed = Args.wrap(\r\n  ({ samplePeriod, maxSize, initialValue, channelName }) => {\r\n    const [buffer, append] = useDataBufferSilent<Pair>({\r\n      maxSize,\r\n      initialValue,\r\n    });\r\n\r\n    useEffect(() => {\r\n      if (channelName === 'debug') {\r\n        let id: number;\r\n\r\n        const receiveData = () => {\r\n          append(generate());\r\n          id = window.setTimeout(\r\n            receiveData,\r\n            samplePeriod + 250 * (Math.random() - 0.5)\r\n          );\r\n        };\r\n        receiveData();\r\n\r\n        return () => clearTimeout(id);\r\n      } else {\r\n        const channel = pusher.channels.channels[channelName];\r\n        if (!channel) {\r\n          LOG('No Pusher channel found for ID:', channelName);\r\n          return;\r\n        }\r\n        const handler = ({ payload }: { payload: Pair[] }) => {\r\n          append(...payload);\r\n          Object.assign(window, { buffer, payload });\r\n        };\r\n        channel.bind(pusherConfig.eventName, handler);\r\n      }\r\n    }, []);\r\n\r\n    return buffer;\r\n  }\r\n);\r\n","export const LOG = (...x: any[]) => (console.log(...x), x.slice(-1)[0]);\r\n","export function deriveCoordinate(\r\n  this: { width: number; height: number },\r\n  coord: Partial<{ width: number; height: number }>\r\n) {\r\n  const { width: w = 0, height: h = 0 } = coord;\r\n  const { width, height } = this;\r\n  const result = w * width + h * height;\r\n  return result;\r\n}\r\n\r\nexport function deriveCoordinates(\r\n  this: { width: number; height: number },\r\n  {\r\n    x = {},\r\n    y = {},\r\n  }: Partial<{\r\n    x: Partial<{ width: number; height: number }>;\r\n    y: Partial<{ width: number; height: number }>;\r\n  }>\r\n) {\r\n  return {\r\n    x: deriveCoordinate.call(this, x),\r\n    y: deriveCoordinate.call(this, y),\r\n  };\r\n}\r\n","import { withImm } from './Imm';\r\n\r\nconst clamp = (x: number, range: [number?, number?]) => {\r\n  const [lo, hi] = withImm.mergeIntersect([-Infinity, Infinity], range);\r\n  return Math.min(hi, Math.max(lo, x));\r\n};\r\n\r\nexport default clamp;\r\n","import { Pair } from 'utils/Pair';\r\nimport { useSpring } from 'react-spring';\r\nimport Denque from 'denque';\r\nimport * as d3 from 'd3';\r\nimport clamp from 'utils/clamp';\r\nimport { useMemo, useRef, useEffect } from 'react';\r\nimport { newEffect } from 'utils/canvas';\r\nimport { required, defaults, declare } from 'utils/DefaultProps';\r\n\r\nconst Args = declare(\r\n  required<{\r\n    scaleX: d3.ScaleLinear<number, number>;\r\n    scaleY: d3.ScaleLinear<number, number>;\r\n    buffer: Denque<Pair>;\r\n  }>(),\r\n  defaults({\r\n    // fraction of timespan to extend memory by for vertical autoscaling\r\n    extraHistory: 0,\r\n  })\r\n);\r\n\r\nexport const useView = Args.wrap(({ scaleX, scaleY, buffer, extraHistory }) => {\r\n  const [{ extent }, set] = useSpring(() => ({\r\n    extent: [0, 0],\r\n    config: { tension: 60, friction: 10 },\r\n  }));\r\n  const currentScaleX = scaleX.copy();\r\n  const bisector = useMemo(() => d3.bisector((d: Pair) => d[0]), []);\r\n  const transformed = useRef([] as Pair[]);\r\n\r\n  useEffect(() => {\r\n    currentScaleX.domain(scaleX.domain()).range(scaleX.range());\r\n  });\r\n\r\n  const update = () => {\r\n    // Adjust the input scale domain for current time.\r\n    const now = Date.now();\r\n    const [start, end] = currentScaleX\r\n      .domain(scaleX.domain().map(x => x + now))\r\n      .domain();\r\n    const timespan = end - start;\r\n\r\n    // Find indices in buffer corresponding to [start, end] times.\r\n    const history = extraHistory * timespan;\r\n    const left = bisector.left(buffer, start - history);\r\n    const right = bisector.right(buffer, end, left);\r\n\r\n    // Pad indices a little so the edge-jitter of the spline is not visible.\r\n    const pad = 2;\r\n    const padRight = clamp(right + pad, [, buffer.length]);\r\n    const padLeft = clamp(left - pad, [0]);\r\n\r\n    // Slice the view of the buffer.\r\n    const compare = ([a]: Pair, [b]: Pair) => +new Date(a) - +new Date(b);\r\n    const view = buffer.slice(padLeft, padRight).sort(compare);\r\n\r\n    // TODO: If I have a lot of free time, add striding to the view, with consistent phase.\r\n\r\n    // Set y-axis scaling for view\r\n    if (view.length) {\r\n      set({ extent: d3.extent(view, d => d[1]) as Pair });\r\n    }\r\n\r\n    scaleY.domain(extent.value);\r\n    transformed.current = view.map(\r\n      ([x, y]): Pair => [currentScaleX(x), scaleY(y)]\r\n    );\r\n  };\r\n\r\n  return [transformed, update, currentScaleX] as [\r\n    typeof transformed,\r\n    typeof update,\r\n    typeof currentScaleX\r\n  ];\r\n});\r\n","import { required } from 'utils/DefaultProps';\r\nimport Denque from 'denque';\r\nimport { Pair } from 'utils/Pair';\r\nimport { RelativeCoordinates } from 'utils/canvas/EnhancedContext';\r\nimport { useEffect } from 'react';\r\nimport { deriveCoordinates } from 'utils/coordinates';\r\nimport { useView } from './useView';\r\nimport { REF } from 'utils/easier';\r\n\r\nconst Args = required<{\r\n  buffer: Denque<Pair>;\r\n  scaleX: d3.ScaleLinear<number, number>;\r\n  scaleY: d3.ScaleLinear<number, number>;\r\n  timespan: REF<number>;\r\n  dims: REF<DOMRect>;\r\n  padDomain: number;\r\n  padRange: RelativeCoordinates;\r\n}>();\r\n\r\nexport const useLine = Args.wrap(\r\n  ({ timespan, dims, padDomain, padRange, ...init }) => {\r\n    useEffect(() => {\r\n      const { x: padX, y: padY } = deriveCoordinates.call(\r\n        dims.current,\r\n        padRange\r\n      );\r\n      init.scaleX.domain([-timespan.current - padDomain, -padDomain]);\r\n      init.scaleX.range([padX, dims.current.width - padX]);\r\n      init.scaleY.range([padY, dims.current.height - padY]);\r\n    });\r\n\r\n    const [view, update, currentScaleX] = useView(init);\r\n    return { view, update, currentScaleX, ...init };\r\n  }\r\n);\r\n","const identity = <T = any>(arg: T) => arg;\r\nexport default identity;\r\n","import { Pair } from 'utils/Pair';\r\nimport identity from './identity';\r\n\r\nexport const diff = <T>(d: Pair<T>, convert: (x: T) => any = identity) =>\r\n  +convert(d[1]) - +convert(d[0]);\r\n","import React, { SVGAttributes } from 'react';\r\nimport { declare, required, defaults } from 'utils/DefaultProps';\r\nimport * as d3 from 'd3';\r\nimport { diff } from 'utils/diff';\r\nimport { Pair } from 'utils/Pair';\r\nimport clamp from 'utils/clamp';\r\nimport { REF } from 'utils/easier';\r\nimport { OpaqueInterpolation, animated, interpolate } from 'react-spring';\r\n\r\nconst Args = declare(\r\n  required<{\r\n    clock: OpaqueInterpolation<number>;\r\n    scale: d3.ScaleLinear<number, number>;\r\n    timespan: REF<number>;\r\n    dims: REF<DOMRect>;\r\n    count: number;\r\n  }>(),\r\n  defaults({\r\n    textStyle: {\r\n      fill: '#888',\r\n      style: {\r\n        font: '14px ubuntu mono, monospace',\r\n      },\r\n    } as SVGAttributes<SVGTextElement>,\r\n    lineStyle: {\r\n      stroke: '#444',\r\n    } as SVGAttributes<SVGLineElement>,\r\n  })\r\n);\r\n\r\nexport const useTicks = Args.wrap(\r\n  ({ clock, scale, timespan, dims, count, textStyle, lineStyle }) => {\r\n    const currentScale = d3.scaleTime();\r\n    const format = currentScale.tickFormat();\r\n\r\n    const data = clock.interpolate(() => {\r\n      currentScale.domain(scale.domain()).range(scale.range());\r\n      const span = diff(currentScale.domain() as Pair<Date>, x => x.getTime());\r\n      const every = clamp(span / timespan.current, [1]);\r\n      const ticks = currentScale.ticks(d3.timeSecond.every(every)!);\r\n      const gap = diff(ticks.slice(0, 2) as Pair<Date>, currentScale) || 0;\r\n      const pad = clamp(0.05 * gap, [1]);\r\n      const height = dims.current.height;\r\n\r\n      return { ticks, pad, height };\r\n    });\r\n\r\n    const Ticks = required<SVGAttributes<SVGGElement>>().wrap(props => (\r\n      <g {...props}>\r\n        {[...Array(count)].map((_, i) => {\r\n          const tick = data.interpolate<Date | 0>(data => data.ticks[i] || 0);\r\n          const t = tick.interpolate(tick => currentScale(tick));\r\n          const height = data.interpolate(data => data.height);\r\n          const pad = data.interpolate(data => data.pad);\r\n          return (\r\n            <animated.g\r\n              key={i}\r\n              transform={t.interpolate(t => `translate(${t},0)`)}\r\n              visibility={tick.interpolate<string>(tick =>\r\n                tick !== 0 ? 'visible' : 'hidden'\r\n              )}\r\n            >\r\n              <animated.line y2={height} {...lineStyle} />\r\n              <animated.text\r\n                x={pad}\r\n                y={interpolate([height, pad], (height, pad) => height - pad)}\r\n                {...textStyle}\r\n              >\r\n                {tick.interpolate(tick => format(tick as Date))}\r\n              </animated.text>\r\n            </animated.g>\r\n          );\r\n        })}\r\n      </g>\r\n    ));\r\n\r\n    const ticks = data.interpolate(data => data.ticks);\r\n\r\n    return [Ticks, ticks, currentScale] as [\r\n      typeof Ticks,\r\n      typeof ticks,\r\n      typeof currentScale\r\n    ];\r\n  }\r\n);\r\n","import { useMemo, useEffect, useRef } from 'react';\r\nimport * as d3 from 'd3';\r\nimport { required, declare, defaults } from 'utils/DefaultProps';\r\nimport { Pair } from 'utils/Pair';\r\nimport noop from 'utils/noop';\r\nimport { REF, CREF } from 'utils/easier';\r\nimport { diff } from '../../utils/diff';\r\n\r\nconst Args = declare(\r\n  required<{\r\n    scale: d3.ScaleLinear<number, number>;\r\n    svgRef: CREF<SVGSVGElement>;\r\n    dims: REF<{ width: number; height: number }>;\r\n  }>(),\r\n  defaults({\r\n    dblclick: 150, // ms\r\n  })\r\n);\r\n\r\nconst slope = (s: d3.ScaleLinear<number, number>) =>\r\n  diff(s.range() as Pair) / diff(s.domain() as Pair);\r\nconst avg = (values: number[]) =>\r\n  values.length ? values.reduce((a, x) => a + x, 0) / values.length : 0;\r\ntype Zoom = d3.ZoomBehavior<SVGSVGElement, any>;\r\n\r\nexport const useControls = Args.wrap(({ scale, svgRef, dims, dblclick }) => {\r\n  const baseScale = scale.copy();\r\n  const effect = useRef(noop);\r\n\r\n  const zoom: Zoom = useMemo(\r\n    () => d3.zoom<SVGSVGElement, any>().scaleExtent([1 / 5, 1]),\r\n    []\r\n  );\r\n\r\n  useEffect(() => {\r\n    const width = dims.current.width;\r\n    zoom.extent([[0, 0], [width, 0]]);\r\n    zoom.translateExtent([[-Infinity, 0], [width, 0]]);\r\n    baseScale.domain(scale.domain()).range(scale.range());\r\n  });\r\n\r\n  useEffect(() => {\r\n    const selection = d3.select(svgRef.current!);\r\n\r\n    zoom\r\n      .on('zoom', () => {\r\n        const t = d3.event.transform as d3.ZoomTransform;\r\n        scale.domain(t.rescaleX(baseScale).domain());\r\n      })\r\n      .duration(dblclick);\r\n\r\n    const paused = (at: number) => () => {\r\n      const delta = Date.now() - at;\r\n      at += delta;\r\n      const dx = delta * slope(baseScale);\r\n      zoom.translateBy(selection, dx, 0);\r\n    };\r\n    let clickID = NaN;\r\n    type States = 'unpaused' | 'waiting' | 'paused' | 'cancelling';\r\n    let state: States = 'unpaused';\r\n    const nextState = (s: States) => {\r\n      const prevState = state;\r\n      switch ((state = s)) {\r\n        case 'unpaused': {\r\n          effect.current = noop;\r\n          break;\r\n        }\r\n        case 'waiting': {\r\n          if (prevState === 'waiting') break;\r\n          const from = { unpaused: 'paused', paused: 'unpaused' } as {\r\n            [k: string]: States;\r\n          };\r\n          clickID = window.setTimeout(() => {\r\n            nextState(from[prevState]);\r\n          }, dblclick);\r\n          break;\r\n        }\r\n        case 'paused': {\r\n          effect.current = paused(Date.now());\r\n          break;\r\n        }\r\n        case 'cancelling': {\r\n          window.clearTimeout(clickID);\r\n          break;\r\n        }\r\n      }\r\n    };\r\n\r\n    const factor = 0.33; // adjust duration calculated by d3.interpolateZoom\r\n    const reset = () => {\r\n      const t = d3.zoomTransform(svgRef.current!);\r\n      const width = diff(scale.range() as Pair);\r\n      const cx = t.x + width / 2;\r\n      const duration =\r\n        factor *\r\n        d3.interpolateZoom(\r\n          [cx, 0, width],\r\n          [avg(baseScale.range()), 0, diff(baseScale.range() as Pair)]\r\n        ).duration;\r\n      selection\r\n        .transition()\r\n        .duration(duration)\r\n        .call(zoom.transform, d3.zoomIdentity);\r\n    };\r\n\r\n    selection\r\n      .call(zoom)\r\n      .on('dblclick.zoom', () => {\r\n        reset();\r\n        nextState('cancelling');\r\n        nextState('unpaused');\r\n      })\r\n      .on('click', () => nextState('waiting'));\r\n\r\n    return () => selection.on('.zoom', null);\r\n  });\r\n\r\n  const update = () => effect.current();\r\n  return update;\r\n});\r\n","import { useCounter, useSilentCounter } from 'utils/CustomHooks';\r\nimport { useEffect, useRef } from 'react';\r\nimport noop from 'utils/noop';\r\nimport { defaults } from 'utils/DefaultProps';\r\n\r\nconst batchMap = new Map<number, FrameRequestCallback[]>();\r\n\r\nexport const Args = defaults({ silent: true, interval: 16, batch: NaN });\r\n\r\nexport function useAnimationFrame(\r\n  f: FrameRequestCallback = noop,\r\n  options = {},\r\n  inputs?: React.InputIdentityList\r\n) {\r\n  const { silent, interval, batch } = Args(options);\r\n\r\n  const firstTime = useRef(true);\r\n  useEffect(() => {\r\n    if (firstTime.current) {\r\n      firstTime.current = false;\r\n    } else {\r\n      console.error(\r\n        \"Options passed to useAnimationFrame were toggled in the same lifecycle of the component. Don't do this! Options must be kept constant or React hooks won't work.\"\r\n      );\r\n    }\r\n  }, [silent, interval, batch]);\r\n\r\n  const [, nextFrame] = silent ? useSilentCounter() : useCounter();\r\n\r\n  useEffect(() => {\r\n    let id: number;\r\n    const tail =\r\n      interval == 16\r\n        ? (callback: FrameRequestCallback) =>\r\n            (id = window.requestAnimationFrame(callback))\r\n        : (callback: FrameRequestCallback) =>\r\n            (id = window.setTimeout(callback, interval));\r\n\r\n    const tracks = isFinite(batch)\r\n      ? batchMap.has(batch)\r\n        ? (batchMap.get(batch)!.push(f), batchMap.get(batch)!)\r\n        : batchMap.set(batch, [f]).get(batch)!\r\n      : batchMap.set(batchMap.size, [f]).get(batchMap.size - 1)!;\r\n\r\n    const loop = (ts: number) => {\r\n      const now = ts || performance.now();\r\n      tracks.forEach(g => g(now));\r\n      nextFrame();\r\n      tail(loop);\r\n    };\r\n\r\n    if (interval == 16) {\r\n      id = window.requestAnimationFrame(loop);\r\n      return () => window.cancelAnimationFrame(id);\r\n    } else {\r\n      id = window.setTimeout(loop, interval);\r\n      return () => window.clearTimeout(id);\r\n    }\r\n  }, inputs);\r\n}\r\n","import { useRef, useCallback } from 'react';\r\n\r\nexport function useSilentCounter(initial: number = 0): [number, () => void] {\r\n  const value = useRef(initial);\r\n  const increment = useCallback(() => value.current++, []);\r\n  return [value.current, increment];\r\n}\r\n","import { useAnimationFrame, Args as FrameArgs } from './useAnimationFrame';\r\nimport { useSpring } from 'react-spring';\r\nimport { defaults } from 'utils/DefaultProps';\r\n\r\nconst Args = FrameArgs.extend(\r\n  defaults({\r\n    // interval: 750,\r\n  })\r\n);\r\n\r\nexport const useAnimationClock = Args.wrap(args => {\r\n  const [{ clock }, update] = useSpring(() => ({\r\n    clock: 0,\r\n    immediate: true,\r\n  }));\r\n  useAnimationFrame(() => {\r\n    update({ clock: clock.value + args.interval });\r\n  }, args);\r\n  return clock;\r\n});\r\n","import React, { useRef, useEffect } from 'react';\r\nimport { GoodCanvasChild } from 'components/GoodCanvas';\r\nimport { Points } from 'components/usePoints';\r\nimport { Line } from 'components/Line';\r\nimport { useDataFeed } from './useDataFeed';\r\nimport { useView } from './useView';\r\nimport { useLine } from './useLine';\r\nimport {\r\n  clear,\r\n  getContext,\r\n  CanvasEffect,\r\n  newEffect,\r\n  EffectOptions,\r\n  RelativeCoordinates,\r\n} from 'utils/canvas';\r\nimport { useDash } from './useDash';\r\nimport { useFPS } from './useFPS';\r\nimport { useTimespan } from './useTimespan';\r\nimport { useClip } from './useClip';\r\nimport { useTicks } from './useTicks';\r\nimport { useControls } from './useControls';\r\nimport { usePaddingSpring } from './usePaddingSpring';\r\nimport * as d3 from 'd3';\r\nimport { diff } from 'utils/diff';\r\nimport { Pair } from 'utils/Pair';\r\nimport clamp from 'utils/clamp';\r\nimport { useGlow } from 'components/Glow';\r\nimport { defaults, declare, required } from 'utils/DefaultProps';\r\nimport { REF, CREF } from 'utils/easier';\r\nimport { animated, AnimatedValue, OpaqueInterpolation } from 'react-spring';\r\nimport { deriveCoordinates } from 'utils/coordinates';\r\nimport Denque from 'denque';\r\nimport { number } from 'prop-types';\r\nimport noop from 'utils/noop';\r\nimport { useAnimationClock } from './useAnimationClock';\r\n\r\nconst Args = declare(\r\n  required<{\r\n    svgRef: CREF<SVGSVGElement>;\r\n    channelNames: string[];\r\n  }>()\r\n);\r\n\r\nexport const _IVPlot = Args.wrap(({ svgRef, channelNames }) => {\r\n  const clock = useAnimationClock();\r\n  const samplePeriod = 400;\r\n\r\n  const dims = useRef<DOMRect>({ width: 0, height: 0 } as DOMRect);\r\n  const timespan = useRef(0);\r\n  const speed = 100;\r\n  useEffect(() => {\r\n    dims.current = svgRef.current!.getBoundingClientRect() as DOMRect;\r\n    timespan.current = dims.current.width / (speed / 1000);\r\n  });\r\n\r\n  const padDomain = 4 * samplePeriod;\r\n  const padRange = { y: { height: 0.1 } };\r\n\r\n  const volts = useLine({\r\n    buffer: useDataFeed({\r\n      samplePeriod: samplePeriod,\r\n      maxSize: 500,\r\n      channelName: channelNames[0],\r\n    }),\r\n    scaleX: d3.scaleLinear(),\r\n    scaleY: d3.scaleLinear(),\r\n    timespan,\r\n    dims,\r\n    padDomain,\r\n    padRange,\r\n  });\r\n\r\n  const amps = useLine({\r\n    buffer: useDataFeed({\r\n      samplePeriod: samplePeriod,\r\n      maxSize: 500,\r\n      channelName: channelNames[1],\r\n    }),\r\n    scaleX: volts.scaleX,\r\n    scaleY: d3.scaleLinear(),\r\n    timespan,\r\n    dims,\r\n    padDomain,\r\n    padRange,\r\n  });\r\n\r\n  const updateControls = useControls({ scale: amps.scaleX, svgRef, dims });\r\n\r\n  const numTicks = 25;\r\n  const [Ticks, ticks, ticksScale] = useTicks({\r\n    ...{ clock, scale: amps.currentScaleX, timespan, dims, count: numTicks },\r\n  });\r\n\r\n  const line = d3.line().curve(d3.curveCatmullRom.alpha(0.5));\r\n\r\n  const sideClip = 0.2;\r\n\r\n  const start = performance.now();\r\n  let count = 0;\r\n  return (\r\n    <>\r\n      <animated.g visibility='hidden'>\r\n        {clock.interpolate(() => {\r\n          // (count % 180 == 0 ? console.clear() : 0) ||\r\n          //   console.log((++count / (performance.now() - start)) * 1000);\r\n          Object.assign(window, {\r\n            svgRef,\r\n            view: amps.view,\r\n            currentScaleX: amps.currentScaleX,\r\n            timespan: timespan.current,\r\n            amps,\r\n            dims,\r\n          });\r\n\r\n          updateControls();\r\n          amps.update();\r\n          volts.update();\r\n        })}\r\n      </animated.g>\r\n      <clipPath id='inside'>\r\n        <animated.rect\r\n          x={clock.interpolate(() => dims.current.height * sideClip)}\r\n          width={clock.interpolate(\r\n            () => dims.current.width - 2 * dims.current.height * sideClip\r\n          )}\r\n          height='100%'\r\n        />\r\n      </clipPath>\r\n      <clipPath id='outside'>\r\n        <animated.rect\r\n          width={clock.interpolate(() => dims.current.height * sideClip)}\r\n          height='100%'\r\n        />\r\n        <animated.rect\r\n          x={clock.interpolate(\r\n            () => dims.current.width - dims.current.height * sideClip\r\n          )}\r\n          width={clock.interpolate(() => dims.current.height * sideClip)}\r\n          height='100%'\r\n        />\r\n      </clipPath>\r\n      <Ticks />\r\n      <g clipPath='url(#inside)'>\r\n        <Line data={amps.view} clock={clock} line={line} />\r\n        <Points\r\n          labelUnit='A'\r\n          ticks={ticks}\r\n          ticksScale={ticksScale}\r\n          scaleY={amps.scaleY}\r\n          data={amps.view}\r\n          count={numTicks}\r\n          curve={line.curve() as d3.CurveCatmullRomFactory}\r\n        />\r\n        <Line\r\n          stroke='hsl(210, 100%, 67%)'\r\n          data={volts.view}\r\n          clock={clock}\r\n          line={line}\r\n        />\r\n        <Points\r\n          labelUnit='V'\r\n          circleStyle={{\r\n            fill: 'hsl(210, 100%, 75%)',\r\n            stroke: 'hsl(210, 100%, 50%)',\r\n          }}\r\n          textStyle={{ fill: 'hsl(210, 100%, 75%)' }}\r\n          ticks={ticks}\r\n          ticksScale={ticksScale}\r\n          scaleY={volts.scaleY}\r\n          data={volts.view}\r\n          count={numTicks}\r\n          curve={line.curve() as d3.CurveCatmullRomFactory}\r\n        />\r\n      </g>\r\n      <g clipPath='url(#outside)'>\r\n        <Line\r\n          data={amps.view}\r\n          clock={clock}\r\n          line={line}\r\n          strokeDasharray='4 6'\r\n          strokeDashoffset={clock.interpolate(t => t / 20)}\r\n        />\r\n        <Line\r\n          strokeDasharray='4 6'\r\n          strokeDashoffset={clock.interpolate(t => t / 20)}\r\n          stroke='hsl(210, 100%, 67%)'\r\n          data={volts.view}\r\n          clock={clock}\r\n          line={line}\r\n        />\r\n      </g>\r\n    </>\r\n  );\r\n\r\n  // const volts = {\r\n  //   buffer: useDataFeed({\r\n  //     samplePeriod: samplePeriod,\r\n  //     maxSize: 40,\r\n  //   }),\r\n  //   scaleX: amps.scaleX,\r\n  //   scaleY: d3.scaleLinear(),\r\n  // };\r\n\r\n  // const {\r\n  //   view: voltsView,\r\n  //   update: updateVoltsView,\r\n  //   currentScaleX\r\n  // } = useView(volts);\r\n\r\n  // const LabelsArgs = declare(\r\n  //   required<{ data: REF<Pair[]>; scaleY: d3.ScaleLinear<number, number> }>(),\r\n  //   defaults({ style: { font: '14px ubuntu mono, monospace' } })\r\n  // );\r\n\r\n  // const useLabels = LabelsArgs.wrap(({ data, scaleY, ...effectOptions }) => {\r\n  //   const format = (x: number) => x.toFixed(1); //d3.format('.1f');\r\n  //   return newEffect(\r\n  //     ctx => {\r\n  //       const pad = clamp(0.01 * ctx.height, [1]);\r\n  //       for (const [x, y] of data.current) {\r\n  //         ctx.fillText(format(scaleY.invert(y)), x + pad, y - pad);\r\n  //       }\r\n  //     },\r\n  //     { ...effectOptions }\r\n  //   );\r\n  // });\r\n\r\n  // const dashed = useDash({ segments: [4, 6], period: 1000 });\r\n  // const inside = useClip({ by: { height: 0.1 } });\r\n  // const outside = useClip({ by: { height: 0.1 }, invert: true });\r\n  // const glow1 = useGlow({\r\n  //   spread: 0.5,\r\n  //   blur: 10,\r\n  //   color: 'hsl(330, 100%, 50%)',\r\n  // });\r\n  // const glow2 = useGlow({\r\n  //   spread: 0.5,\r\n  //   blur: 10,\r\n  //   color: 'hsl(210, 100%, 50%)',\r\n  // });\r\n  // // const line = useLine({\r\n  // //   data: ampsView,\r\n  // //   style: { strokeStyle: 'hsl(330, 100%, 67%)' },\r\n  // // });\r\n  // const points = usePoints({ data: ampsView });\r\n  // // const line2 = useLine({\r\n  // //   data: voltsView,\r\n  // //   style: { strokeStyle: 'hsl(210, 100%, 67%)' },\r\n  // // });\r\n  // const points2 = usePoints({\r\n  //   data: voltsView,\r\n  //   style: {\r\n  //     fillStyle: 'hsl(210, 100%, 75%)',\r\n  //     strokeStyle: 'hsl(210, 100%, 50%)',\r\n  //   },\r\n  // });\r\n\r\n  // const animations: CanvasEffect[] = [\r\n  //   updateZoomedScale,\r\n  //   updateAmpsView,\r\n  //   updateVoltsView,\r\n  //   clear,\r\n  //   useTicks({ viewScale }),\r\n  //   // outside(dashed(line), dashed(line2)),\r\n  //   inside(\r\n  //     // line,\r\n  //     points(useLabels({ data: ampsView, scaleY })),\r\n  //     // line2,\r\n  //     points2(useLabels({ data: voltsView, scaleY: scaleY2 }))\r\n  //   ),\r\n  //   useFPS({\r\n  //     offset: { x: { height: -0.1 }, y: { height: -0.9 } },\r\n  //     style: { fillStyle: 'hsl(90, 75%, 50%)' },\r\n  //   }),\r\n  // ];\r\n\r\n  // // let n = 0;\r\n  // useAnimationFrame(\r\n  //   ts => {\r\n  //     const { ctx } = getContext(props.canvasRef);\r\n  //     animations.forEach(e => e(ctx));\r\n  //     // console.log('frame:', ++n, 'ts:', ts);\r\n  //   }\r\n  //   // ,{ batch: 0, interval: 500 }\r\n  // );\r\n\r\n  // return null;\r\n});\r\n","import { withImm } from 'utils/Imm';\r\n\r\nexport interface Args {\r\n  event: string;\r\n  customEvent: string;\r\n  _window?: typeof window;\r\n}\r\n\r\nexport const defaultArgs = {\r\n  _window: window,\r\n};\r\n\r\nconst throttle = (args: Args) => {\r\n  // unpack args\r\n  const { _window } = withImm.mergeIntersect(defaultArgs, args);\r\n  const { event, customEvent } = args;\r\n\r\n  if (!event) throw Error('`event` should not be blank');\r\n  if (!customEvent) throw Error('`customEvent` should not be blank');\r\n\r\n  let ready = true;\r\n\r\n  const dispatcher = () => {\r\n    // dispatchEvent is synchronous (waits for event listener to finish running)\r\n    _window!.dispatchEvent(new CustomEvent(customEvent));\r\n    ready = true;\r\n  };\r\n\r\n  const throttler = () => {\r\n    if (ready) {\r\n      ready = false;\r\n      requestAnimationFrame(dispatcher);\r\n    }\r\n  };\r\n\r\n  _window!.addEventListener(event, throttler, { passive: true });\r\n\r\n  const cleanup = () => {\r\n    _window!.removeEventListener(event, throttler);\r\n  };\r\n\r\n  return cleanup;\r\n};\r\n\r\nexport const optimizedResize = 'optimized-resize';\r\nthrottle({ event: 'resize', customEvent: optimizedResize });\r\n\r\nexport default throttle;\r\n","import React, { useEffect } from 'react';\r\nimport { optimizedResize } from 'utils/throttleEvent';\r\nimport { useThrottled } from 'utils/CustomHooks';\r\nimport { BaseProps } from 'utils/BaseProps';\r\nimport { declare, defaults } from 'utils/DefaultProps';\r\nimport { REF } from 'utils/easier';\r\nimport { animated, useSpring } from 'react-spring';\r\n\r\nexport const Props = declare(\r\n  defaults({\r\n    radius: 5,\r\n    timeout: 250,\r\n    enabled: true,\r\n    style: { filter: '' } as typeof BaseProps.propsOut.style,\r\n  }),\r\n  BaseProps\r\n);\r\n\r\nexport const OwnProps = declare(Props.own);\r\n\r\nconst Blur = Props.wrap(\r\n  ({ children, style, radius, timeout, enabled }, ref: REF<HTMLDivElement>) => {\r\n    const [{ filter }, update] = useSpring(() => ({\r\n      filter: `${style.filter} blur(0px)`,\r\n      from: {\r\n        filter: `${style.filter} blur(${radius}px)`,\r\n      },\r\n      config: { duration: 250 },\r\n    }));\r\n\r\n    // attach handler to blur on window resize\r\n    useThrottled(\r\n      {\r\n        event: optimizedResize,\r\n        first: () =>\r\n          update({\r\n            filter: `${style.filter} blur(${enabled ? radius : 0}px)`,\r\n          }),\r\n        last: () =>\r\n          update({\r\n            filter: `${style.filter} blur(0px)`,\r\n          }),\r\n        timeout,\r\n      },\r\n      [timeout]\r\n    );\r\n\r\n    // attach handler to blur on visibility change\r\n    useEffect(() => {\r\n      const handler = () => {\r\n        update({\r\n          filter: `${style.filter} blur(${\r\n            enabled && document.hidden ? radius : 0\r\n          }px)`,\r\n        });\r\n      };\r\n      document.addEventListener('visibilitychange', handler);\r\n      return () => document.removeEventListener('visibilitychange', handler);\r\n    }, [style.filter, enabled, radius]);\r\n\r\n    return (\r\n      <animated.div\r\n        ref={ref}\r\n        style={{\r\n          ...style,\r\n          filter,\r\n        }}\r\n      >\r\n        {children}\r\n      </animated.div>\r\n    );\r\n  }\r\n);\r\n\r\nexport default React.forwardRef(Blur);\r\n","import React, { useRef } from 'react';\r\nimport { _IVPlot } from './_IVPlot';\r\nimport { defaults, required } from 'utils/DefaultProps';\r\nimport Blur, { Props as BlurProps } from 'components/Blur';\r\nimport { useThrottled, useCounter } from 'utils/CustomHooks';\r\nimport { optimizedResize } from 'utils/throttleEvent';\r\nimport { Omit } from 'utils/meta';\r\n\r\nexport const Props = BlurProps.extend(\r\n  required<Omit<typeof _IVPlot.required, 'svgRef'>>(),\r\n  defaults({\r\n    style: {\r\n      position: 'relative',\r\n      width: '100%',\r\n      height: '100%',\r\n      borderRadius: '5px',\r\n      // border: '10px solid blue',\r\n      backgroundColor: '#040404',\r\n    },\r\n  })\r\n);\r\n\r\nconst IVPlot = Props.wrap(({ channelNames, ...rest }) => {\r\n  const svgRef = useRef<SVGSVGElement>(null);\r\n\r\n  // Re-render on resize\r\n  const [, tick] = useCounter();\r\n  useThrottled(\r\n    {\r\n      event: optimizedResize,\r\n      last: tick,\r\n    },\r\n    []\r\n  );\r\n\r\n  return (\r\n    <Blur {...rest}>\r\n      <svg ref={svgRef} width='100%' height='100%'>\r\n        <_IVPlot channelNames={channelNames} svgRef={svgRef} />\r\n      </svg>\r\n    </Blur>\r\n  );\r\n});\r\n\r\nexport default IVPlot;\r\n\r\n/* \r\n// canvasStyle={lightMode.current.line.canvasStyle}\r\n      // glow={lightMode.current.line.glow}\r\n*/\r\n// blur={{ radius: 10 }}\r\n// canvasStyle={lightMode.current.points.canvasStyle}\r\n// glow={lightMode.current.points.glow}\r\n","import React from 'react';\r\nexport const Wifi = props => {\r\n  const bars = [\r\n    null,\r\n    <path d=\"M 12 18 C 11.5 18 10.992188 18.199219 10.59375 18.5 L 12 20 L 13.40625 18.5 C 13.007813 18.199219 12.5 18 12 18 Z\" />,\r\n    <path d=\"M 12 13 C 10.148438 13 8.484375 13.726563 7.21875 14.875 L 8.5625 16.34375 C 9.496094 15.492188 10.648438 15 12 15 C 13.351563 15 14.503906 15.492188 15.4375 16.34375 L 16.78125 14.875 C 15.515625 13.726563 13.851563 13 12 13 Z \" />,\r\n    <path d=\"M 12 8 C 8.847656 8 5.988281 9.214844 3.8125 11.28125 L 5.1875 12.71875 C 7.011719 10.984375 9.351563 10 12 10 C 14.625 10 17 11.089844 18.84375 12.75 L 20.15625 11.25 C 18 9.308594 15.175781 8 12 8 Z \" />,\r\n    <path d=\"M 12 3 C 7.546875 3 3.398438 4.707031 0.40625 7.59375 L 1.78125 9.03125 C 4.390625 6.515625 8.054688 5 12 5 C 15.945313 5 19.492188 6.492188 22.21875 9.03125 L 23.59375 7.5625 C 20.519531 4.699219 16.453125 3 12 3 Z \" />,\r\n  ];\r\n\r\n  return (\r\n    <div\r\n      style={{\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n      }}\r\n    >\r\n      <svg\r\n        viewBox=\"0 0 24 24\"\r\n        style={{\r\n          width: '1em',\r\n          height: '1em',\r\n          fill: 'white',\r\n        }}\r\n      >\r\n        {React.Children.map(bars, (e, i) => {\r\n          if (!React.isValidElement(e)) return;\r\n          const opacity = i <= props.level ? 1 : 0.3;\r\n          return React.cloneElement(e, { style: { opacity } });\r\n        })}\r\n      </svg>\r\n      <div style={{ marginLeft: '1ex' }}>utexas</div>\r\n    </div>\r\n  );\r\n};\r\n","import React from 'react';\r\nimport { useAnimationClock } from '../IVPlot/useAnimationClock';\r\nimport { animated } from 'react-spring';\r\nexport function Time() {\r\n  const clock = useAnimationClock();\r\n  return (\r\n    <animated.div\r\n      style={{\r\n        position: 'absolute',\r\n        left: '50%',\r\n        transform: 'translateX(-50%)',\r\n      }}\r\n    >\r\n      {clock.interpolate(() => new Date().toLocaleTimeString())}\r\n    </animated.div>\r\n  );\r\n}\r\n","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport React from 'react';\n\nvar _ref =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M 12 1 C 8.6761905 1 6 3.6761905 6 7 L 6 8 C 4.9 8 4 8.9 4 10 L 4 20 C 4 21.1 4.9 22 6 22 L 18 22 C 19.1 22 20 21.1 20 20 L 20 10 C 20 8.9 19.1 8 18 8 L 18 7 C 18 3.6761905 15.32381 1 12 1 z M 12 3 C 14.27619 3 16 4.7238095 16 7 L 16 8 L 8 8 L 8 7 C 8 4.7238095 9.7238095 3 12 3 z M 12 13 C 13.1 13 14 13.9 14 15 C 14 16.1 13.1 17 12 17 C 10.9 17 10 16.1 10 15 C 10 13.9 10.9 13 12 13 z\"\n});\n\nvar SvgComponent = function SvgComponent(props) {\n  return React.createElement(\"svg\", _extends({\n    viewBox: \"0 0 24 24\"\n  }, props), _ref);\n};\n\nexport default __webpack_public_path__ + \"static/media/lock.9b40595e.svg\";\nexport { SvgComponent as ReactComponent };","import React from 'react';\r\nimport { ReactComponent as Lock } from './lock.svg';\r\nexport function Login(props) {\r\n  return (\r\n    <div\r\n      style={{\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n      }}\r\n    >\r\n      <Lock\r\n        style={{\r\n          display: props.username === 'Guest' ? 'none' : 'initial',\r\n          width: '1em',\r\n          height: '1em',\r\n          fill: 'white',\r\n        }}\r\n      />\r\n      <div style={{ marginLeft: '1ex' }}> Welcome, {props.username}</div>\r\n    </div>\r\n  );\r\n}\r\n","import React, { useState } from 'react';\r\nimport { Wifi } from './Wifi';\r\nimport { Time } from './Time';\r\nimport { Login } from './Login';\r\nconst TitleBar = () => {\r\n  const [state] = useState({\r\n    level: 4,\r\n    username:\r\n      new URL(document.location).searchParams.get('username') || 'Guest',\r\n  });\r\n\r\n  return (\r\n    <div\r\n      style={{\r\n        font: '1em monospace',\r\n        lineHeight: '1.25em',\r\n        backgroundColor: '#222',\r\n        color: 'white',\r\n        display: 'flex',\r\n        justifyContent: 'space-between',\r\n        alignItems: 'center',\r\n        paddingLeft: '2ex',\r\n        paddingRight: '2ex',\r\n        position: 'relative',\r\n      }}\r\n    >\r\n      <Wifi level={state.level} />\r\n      <Time />\r\n      <Login username={state.username} />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default TitleBar;\r\n","import React, { SVGAttributes, useState, useEffect, useRef } from 'react';\r\nimport pusher from 'components/Pusher';\r\nimport { required } from 'utils/DefaultProps';\r\nimport { Pair } from 'utils/Pair';\r\nimport {\r\n  useSpring,\r\n  animated,\r\n  config,\r\n  interpolate,\r\n  OpaqueInterpolation,\r\n} from 'react-spring';\r\nimport { LOG } from 'components/IVPlot/LOG';\r\nimport clamp from 'utils/clamp';\r\n\r\nconst Args = required<SVGAttributes<SVGElement>>().extend(\r\n  required<{\r\n    panelIdx: number;\r\n  }>()\r\n);\r\n\r\nconst average = (x: Pair[]) =>\r\n  x.reduce((a, v) => a + v[1], 0) / (x.length || 1);\r\n\r\nconst CirclePlot = Args.wrap(props => {\r\n  const [{ power }, set] = useSpring(() => ({\r\n    power: 0,\r\n    // config: config.slow,\r\n    immediate: true,\r\n  }));\r\n  const voltage = useRef(0);\r\n  const current = useRef(0);\r\n\r\n  const { panelIdx, ...rest } = props;\r\n  (window as any).p = pusher;\r\n  const timeout = useRef(NaN);\r\n  useEffect(() => {\r\n    // clear after a minute of no pusher activity;\r\n    const refresh = () => {\r\n      if (timeout.current) window.clearTimeout(timeout.current);\r\n      timeout.current = +window.setTimeout(() => {\r\n        voltage.current = current.current = 0;\r\n        set({ power: 0 });\r\n        timeout.current = NaN;\r\n      }, 10e3);\r\n    };\r\n    refresh();\r\n    const voltageChannel = pusher.channels.channels['ch' + 2 * panelIdx];\r\n    voltageChannel.bind('new-data', ({ payload }: { payload: Pair[] }) => {\r\n      voltage.current = average(payload);\r\n      set({\r\n        power:\r\n          (power.value * 0.9) / 60 +\r\n          (0.1 / 60) * current.current * voltage.current,\r\n      });\r\n      refresh();\r\n    });\r\n\r\n    const currentChannel = pusher.channels.channels['ch' + (2 * panelIdx + 1)];\r\n    if (!currentChannel) return;\r\n    currentChannel.bind('new-data', ({ payload }: { payload: Pair[] }) => {\r\n      current.current = average(payload);\r\n      set({ power: current.current * voltage.current });\r\n      refresh();\r\n    });\r\n  }, []);\r\n  const progress = power.interpolate(x =>\r\n    clamp(x / 48, [0, 1])\r\n  ) as OpaqueInterpolation<number>;\r\n  const C = Math.PI * 2 * 49;\r\n  return (\r\n    <svg viewBox='0 0 100 100' {...rest}>\r\n      <circle\r\n        cx='50'\r\n        cy='50'\r\n        r='49.875'\r\n        fill='transparent'\r\n        stroke='#1a1a1a'\r\n        strokeWidth='.25'\r\n      />\r\n      <g transform={`translate(50 50) scale(${46.75 / 50}) translate(-50 -50)`}>\r\n        <circle\r\n          cx='50'\r\n          cy='50'\r\n          r='45'\r\n          fill='transparent'\r\n          stroke='#222'\r\n          strokeWidth='3'\r\n          strokeDasharray='1 2'\r\n        />\r\n        <circle\r\n          cx='50'\r\n          cy='50'\r\n          r='49'\r\n          fill='transparent'\r\n          stroke='#222'\r\n          strokeWidth='2'\r\n        />\r\n        <animated.circle\r\n          cx='50'\r\n          cy='50'\r\n          r='49'\r\n          fill='transparent'\r\n          stroke='green'\r\n          strokeWidth='2'\r\n          // strokeLinecap='round'\r\n          strokeDasharray={`${C} ${C}`}\r\n          strokeDashoffset={progress.interpolate(v => (1 - v) * C)}\r\n          transform='rotate(-90 50 50)'\r\n        />\r\n        <text\r\n          x='50'\r\n          y='45'\r\n          fill='white'\r\n          style={{ fontFamily: 'ubuntu mono, monospace' }}\r\n          fontSize='40'\r\n        >\r\n          <animated.tspan textAnchor='middle' alignmentBaseline='middle'>\r\n            {progress.interpolate(v => (v * 100).toFixed(0))}\r\n          </animated.tspan>\r\n          <tspan alignmentBaseline='baseline' fontSize='15' dy='-5'>\r\n            %\r\n          </tspan>\r\n          <tspan\r\n            x='50'\r\n            y='72.5'\r\n            fontSize='10'\r\n            textAnchor='middle'\r\n            alignmentBaseline='middle'\r\n          >\r\n            MAX\r\n          </tspan>\r\n        </text>\r\n      </g>\r\n    </svg>\r\n  );\r\n});\r\n\r\nexport default CirclePlot;\r\n","const module = {};\r\n\r\n(function(module) {\r\n  /* Set up a RequestAnimationFrame shim so we can animate efficiently FOR\r\n   * GREAT JUSTICE. */\r\n  var requestInterval, cancelInterval;\r\n\r\n  (function() {\r\n    var raf = window.requestAnimationFrame,\r\n      caf = window.cancelAnimationFrame;\r\n\r\n    if (raf && caf) {\r\n      requestInterval = function(fn) {\r\n        var handle = { value: null };\r\n\r\n        function loop() {\r\n          handle.value = raf(loop);\r\n          fn();\r\n        }\r\n\r\n        loop();\r\n        return handle;\r\n      };\r\n\r\n      cancelInterval = function(handle) {\r\n        caf(handle.value);\r\n      };\r\n    } else {\r\n      requestInterval = setInterval;\r\n      cancelInterval = clearInterval;\r\n    }\r\n  })();\r\n\r\n  /* Catmull-rom spline stuffs. */\r\n  /*\r\n  function upsample(n, spline) {\r\n    var polyline = [],\r\n        len = spline.length,\r\n        bx  = spline[0],\r\n        by  = spline[1],\r\n        cx  = spline[2],\r\n        cy  = spline[3],\r\n        dx  = spline[4],\r\n        dy  = spline[5],\r\n        i, j, ax, ay, px, qx, rx, sx, py, qy, ry, sy, t;\r\n\r\n    for(i = 6; i !== spline.length; i += 2) {\r\n      ax = bx;\r\n      bx = cx;\r\n      cx = dx;\r\n      dx = spline[i    ];\r\n      px = -0.5 * ax + 1.5 * bx - 1.5 * cx + 0.5 * dx;\r\n      qx =        ax - 2.5 * bx + 2.0 * cx - 0.5 * dx;\r\n      rx = -0.5 * ax            + 0.5 * cx           ;\r\n      sx =                   bx                      ;\r\n\r\n      ay = by;\r\n      by = cy;\r\n      cy = dy;\r\n      dy = spline[i + 1];\r\n      py = -0.5 * ay + 1.5 * by - 1.5 * cy + 0.5 * dy;\r\n      qy =        ay - 2.5 * by + 2.0 * cy - 0.5 * dy;\r\n      ry = -0.5 * ay            + 0.5 * cy           ;\r\n      sy =                   by                      ;\r\n\r\n      for(j = 0; j !== n; ++j) {\r\n        t = j / n;\r\n\r\n        polyline.push(\r\n          ((px * t + qx) * t + rx) * t + sx,\r\n          ((py * t + qy) * t + ry) * t + sy\r\n        );\r\n      }\r\n    }\r\n\r\n    polyline.push(\r\n      px + qx + rx + sx,\r\n      py + qy + ry + sy\r\n    );\r\n\r\n    return polyline;\r\n  }\r\n\r\n  function downsample(n, polyline) {\r\n    var len = 0,\r\n        i, dx, dy;\r\n\r\n    for(i = 2; i !== polyline.length; i += 2) {\r\n      dx = polyline[i    ] - polyline[i - 2];\r\n      dy = polyline[i + 1] - polyline[i - 1];\r\n      len += Math.sqrt(dx * dx + dy * dy);\r\n    }\r\n\r\n    len /= n;\r\n\r\n    var small = [],\r\n        target = len,\r\n        min = 0,\r\n        max, t;\r\n\r\n    small.push(polyline[0], polyline[1]);\r\n\r\n    for(i = 2; i !== polyline.length; i += 2) {\r\n      dx = polyline[i    ] - polyline[i - 2];\r\n      dy = polyline[i + 1] - polyline[i - 1];\r\n      max = min + Math.sqrt(dx * dx + dy * dy);\r\n\r\n      if(max > target) {\r\n        t = (target - min) / (max - min);\r\n\r\n        small.push(\r\n          polyline[i - 2] + dx * t,\r\n          polyline[i - 1] + dy * t\r\n        );\r\n\r\n        target += len;\r\n      }\r\n\r\n      min = max;\r\n    }\r\n\r\n    small.push(polyline[polyline.length - 2], polyline[polyline.length - 1]);\r\n\r\n    return small;\r\n  }\r\n  */\r\n\r\n  /* Define skycon things. */\r\n  /* FIXME: I'm *really really* sorry that this code is so gross. Really, I am.\r\n   * I'll try to clean it up eventually! Promise! */\r\n  var KEYFRAME = 500,\r\n    STROKE = 0.08,\r\n    TAU = 2.0 * Math.PI,\r\n    TWO_OVER_SQRT_2 = 2.0 / Math.sqrt(2);\r\n\r\n  function circle(ctx, x, y, r) {\r\n    ctx.beginPath();\r\n    ctx.arc(x, y, r, 0, TAU, false);\r\n    ctx.fill();\r\n  }\r\n\r\n  function line(ctx, ax, ay, bx, by) {\r\n    ctx.beginPath();\r\n    ctx.moveTo(ax, ay);\r\n    ctx.lineTo(bx, by);\r\n    ctx.stroke();\r\n  }\r\n\r\n  function puff(ctx, t, cx, cy, rx, ry, rmin, rmax) {\r\n    var c = Math.cos(t * TAU),\r\n      s = Math.sin(t * TAU);\r\n\r\n    rmax -= rmin;\r\n\r\n    circle(\r\n      ctx,\r\n      cx - s * rx,\r\n      cy + c * ry + rmax * 0.5,\r\n      rmin + (1 - c * 0.5) * rmax\r\n    );\r\n  }\r\n\r\n  function puffs(ctx, t, cx, cy, rx, ry, rmin, rmax) {\r\n    var i;\r\n\r\n    for (i = 5; i--; ) puff(ctx, t + i / 5, cx, cy, rx, ry, rmin, rmax);\r\n  }\r\n\r\n  function cloud(ctx, t, cx, cy, cw, s, color) {\r\n    t /= 30000;\r\n\r\n    var a = cw * 0.21,\r\n      b = cw * 0.12,\r\n      c = cw * 0.24,\r\n      d = cw * 0.28;\r\n\r\n    ctx.fillStyle = color;\r\n    puffs(ctx, t, cx, cy, a, b, c, d);\r\n\r\n    ctx.globalCompositeOperation = 'destination-out';\r\n    puffs(ctx, t, cx, cy, a, b, c - s, d - s);\r\n    ctx.globalCompositeOperation = 'source-over';\r\n  }\r\n\r\n  function sun(ctx, t, cx, cy, cw, s, color) {\r\n    t /= 120000;\r\n\r\n    var a = cw * 0.25 - s * 0.5,\r\n      b = cw * 0.32 + s * 0.5,\r\n      c = cw * 0.5 - s * 0.5,\r\n      i,\r\n      p,\r\n      cos,\r\n      sin;\r\n\r\n    ctx.strokeStyle = color;\r\n    ctx.lineWidth = s;\r\n    ctx.lineCap = 'round';\r\n    ctx.lineJoin = 'round';\r\n\r\n    ctx.beginPath();\r\n    ctx.arc(cx, cy, a, 0, TAU, false);\r\n    ctx.stroke();\r\n\r\n    for (i = 8; i--; ) {\r\n      p = (t + i / 8) * TAU;\r\n      cos = Math.cos(p);\r\n      sin = Math.sin(p);\r\n      line(ctx, cx + cos * b, cy + sin * b, cx + cos * c, cy + sin * c);\r\n    }\r\n  }\r\n\r\n  function moon(ctx, t, cx, cy, cw, s, color) {\r\n    t /= 15000;\r\n\r\n    var a = cw * 0.29 - s * 0.5,\r\n      b = cw * 0.05,\r\n      c = Math.cos(t * TAU),\r\n      p = (c * TAU) / -16;\r\n\r\n    ctx.strokeStyle = color;\r\n    ctx.lineWidth = s;\r\n    ctx.lineCap = 'round';\r\n    ctx.lineJoin = 'round';\r\n\r\n    cx += c * b;\r\n\r\n    ctx.beginPath();\r\n    ctx.arc(cx, cy, a, p + TAU / 8, p + (TAU * 7) / 8, false);\r\n    ctx.arc(\r\n      cx + Math.cos(p) * a * TWO_OVER_SQRT_2,\r\n      cy + Math.sin(p) * a * TWO_OVER_SQRT_2,\r\n      a,\r\n      p + (TAU * 5) / 8,\r\n      p + (TAU * 3) / 8,\r\n      true\r\n    );\r\n    ctx.closePath();\r\n    ctx.stroke();\r\n  }\r\n\r\n  function rain(ctx, t, cx, cy, cw, s, color) {\r\n    t /= 1350;\r\n\r\n    var a = cw * 0.16,\r\n      b = (TAU * 11) / 12,\r\n      c = (TAU * 7) / 12,\r\n      i,\r\n      p,\r\n      x,\r\n      y;\r\n\r\n    ctx.fillStyle = color;\r\n\r\n    for (i = 4; i--; ) {\r\n      p = (t + i / 4) % 1;\r\n      x = cx + ((i - 1.5) / 1.5) * (i === 1 || i === 2 ? -1 : 1) * a;\r\n      y = cy + p * p * cw;\r\n      ctx.beginPath();\r\n      ctx.moveTo(x, y - s * 1.5);\r\n      ctx.arc(x, y, s * 0.75, b, c, false);\r\n      ctx.fill();\r\n    }\r\n  }\r\n\r\n  function sleet(ctx, t, cx, cy, cw, s, color) {\r\n    t /= 750;\r\n\r\n    var a = cw * 0.1875,\r\n      i,\r\n      p,\r\n      x,\r\n      y;\r\n\r\n    ctx.strokeStyle = color;\r\n    ctx.lineWidth = s * 0.5;\r\n    ctx.lineCap = 'round';\r\n    ctx.lineJoin = 'round';\r\n\r\n    for (i = 4; i--; ) {\r\n      p = (t + i / 4) % 1;\r\n      x =\r\n        Math.floor(cx + ((i - 1.5) / 1.5) * (i === 1 || i === 2 ? -1 : 1) * a) +\r\n        0.5;\r\n      y = cy + p * cw;\r\n      line(ctx, x, y - s * 1.5, x, y + s * 1.5);\r\n    }\r\n  }\r\n\r\n  function snow(ctx, t, cx, cy, cw, s, color) {\r\n    t /= 3000;\r\n\r\n    var a = cw * 0.16,\r\n      b = s * 0.75,\r\n      u = t * TAU * 0.7,\r\n      ux = Math.cos(u) * b,\r\n      uy = Math.sin(u) * b,\r\n      v = u + TAU / 3,\r\n      vx = Math.cos(v) * b,\r\n      vy = Math.sin(v) * b,\r\n      w = u + (TAU * 2) / 3,\r\n      wx = Math.cos(w) * b,\r\n      wy = Math.sin(w) * b,\r\n      i,\r\n      p,\r\n      x,\r\n      y;\r\n\r\n    ctx.strokeStyle = color;\r\n    ctx.lineWidth = s * 0.5;\r\n    ctx.lineCap = 'round';\r\n    ctx.lineJoin = 'round';\r\n\r\n    for (i = 4; i--; ) {\r\n      p = (t + i / 4) % 1;\r\n      x = cx + Math.sin((p + i / 4) * TAU) * a;\r\n      y = cy + p * cw;\r\n\r\n      line(ctx, x - ux, y - uy, x + ux, y + uy);\r\n      line(ctx, x - vx, y - vy, x + vx, y + vy);\r\n      line(ctx, x - wx, y - wy, x + wx, y + wy);\r\n    }\r\n  }\r\n\r\n  function fogbank(ctx, t, cx, cy, cw, s, color) {\r\n    t /= 30000;\r\n\r\n    var a = cw * 0.21,\r\n      b = cw * 0.06,\r\n      c = cw * 0.21,\r\n      d = cw * 0.28;\r\n\r\n    ctx.fillStyle = color;\r\n    puffs(ctx, t, cx, cy, a, b, c, d);\r\n\r\n    ctx.globalCompositeOperation = 'destination-out';\r\n    puffs(ctx, t, cx, cy, a, b, c - s, d - s);\r\n    ctx.globalCompositeOperation = 'source-over';\r\n  }\r\n\r\n  /*\r\n  var WIND_PATHS = [\r\n        downsample(63, upsample(8, [\r\n          -1.00, -0.28,\r\n          -0.75, -0.18,\r\n          -0.50,  0.12,\r\n          -0.20,  0.12,\r\n          -0.04, -0.04,\r\n          -0.07, -0.18,\r\n          -0.19, -0.18,\r\n          -0.23, -0.05,\r\n          -0.12,  0.11,\r\n           0.02,  0.16,\r\n           0.20,  0.15,\r\n           0.50,  0.07,\r\n           0.75,  0.18,\r\n           1.00,  0.28\r\n        ])),\r\n        downsample(31, upsample(16, [\r\n          -1.00, -0.10,\r\n          -0.75,  0.00,\r\n          -0.50,  0.10,\r\n          -0.25,  0.14,\r\n           0.00,  0.10,\r\n           0.25,  0.00,\r\n           0.50, -0.10,\r\n           0.75, -0.14,\r\n           1.00, -0.10\r\n        ]))\r\n      ];\r\n  */\r\n\r\n  var WIND_PATHS = [\r\n      [\r\n        -0.75,\r\n        -0.18,\r\n        -0.7219,\r\n        -0.1527,\r\n        -0.6971,\r\n        -0.1225,\r\n        -0.6739,\r\n        -0.091,\r\n        -0.6516,\r\n        -0.0588,\r\n        -0.6298,\r\n        -0.0262,\r\n        -0.6083,\r\n        0.0065,\r\n        -0.5868,\r\n        0.0396,\r\n        -0.5643,\r\n        0.0731,\r\n        -0.5372,\r\n        0.1041,\r\n        -0.5033,\r\n        0.1259,\r\n        -0.4662,\r\n        0.1406,\r\n        -0.4275,\r\n        0.1493,\r\n        -0.3881,\r\n        0.153,\r\n        -0.3487,\r\n        0.1526,\r\n        -0.3095,\r\n        0.1488,\r\n        -0.2708,\r\n        0.1421,\r\n        -0.2319,\r\n        0.1342,\r\n        -0.1943,\r\n        0.1217,\r\n        -0.16,\r\n        0.1025,\r\n        -0.129,\r\n        0.0785,\r\n        -0.1012,\r\n        0.0509,\r\n        -0.0764,\r\n        0.0206,\r\n        -0.0547,\r\n        -0.012,\r\n        -0.0378,\r\n        -0.0472,\r\n        -0.0324,\r\n        -0.0857,\r\n        -0.0389,\r\n        -0.1241,\r\n        -0.0546,\r\n        -0.1599,\r\n        -0.0814,\r\n        -0.1876,\r\n        -0.1193,\r\n        -0.1964,\r\n        -0.1582,\r\n        -0.1935,\r\n        -0.1931,\r\n        -0.1769,\r\n        -0.2157,\r\n        -0.1453,\r\n        -0.229,\r\n        -0.1085,\r\n        -0.2327,\r\n        -0.0697,\r\n        -0.224,\r\n        -0.0317,\r\n        -0.2064,\r\n        0.0033,\r\n        -0.1853,\r\n        0.0362,\r\n        -0.1613,\r\n        0.0672,\r\n        -0.135,\r\n        0.0961,\r\n        -0.1051,\r\n        0.1213,\r\n        -0.0706,\r\n        0.1397,\r\n        -0.0332,\r\n        0.1512,\r\n        0.0053,\r\n        0.158,\r\n        0.0442,\r\n        0.1624,\r\n        0.0833,\r\n        0.1636,\r\n        0.1224,\r\n        0.1615,\r\n        0.1613,\r\n        0.1565,\r\n        0.1999,\r\n        0.15,\r\n        0.2378,\r\n        0.1402,\r\n        0.2749,\r\n        0.1279,\r\n        0.3118,\r\n        0.1147,\r\n        0.3487,\r\n        0.1015,\r\n        0.3858,\r\n        0.0892,\r\n        0.4236,\r\n        0.0787,\r\n        0.4621,\r\n        0.0715,\r\n        0.5012,\r\n        0.0702,\r\n        0.5398,\r\n        0.0766,\r\n        0.5768,\r\n        0.089,\r\n        0.6123,\r\n        0.1055,\r\n        0.6466,\r\n        0.1244,\r\n        0.6805,\r\n        0.144,\r\n        0.7147,\r\n        0.163,\r\n        0.75,\r\n        0.18,\r\n      ],\r\n      [\r\n        -0.75,\r\n        0.0,\r\n        -0.7033,\r\n        0.0195,\r\n        -0.6569,\r\n        0.0399,\r\n        -0.6104,\r\n        0.06,\r\n        -0.5634,\r\n        0.0789,\r\n        -0.5155,\r\n        0.0954,\r\n        -0.4667,\r\n        0.1089,\r\n        -0.4174,\r\n        0.1206,\r\n        -0.3676,\r\n        0.1299,\r\n        -0.3174,\r\n        0.1365,\r\n        -0.2669,\r\n        0.1398,\r\n        -0.2162,\r\n        0.1391,\r\n        -0.1658,\r\n        0.1347,\r\n        -0.1157,\r\n        0.1271,\r\n        -0.0661,\r\n        0.1169,\r\n        -0.017,\r\n        0.1046,\r\n        0.0316,\r\n        0.0903,\r\n        0.0791,\r\n        0.0728,\r\n        0.1259,\r\n        0.0534,\r\n        0.1723,\r\n        0.0331,\r\n        0.2188,\r\n        0.0129,\r\n        0.2656,\r\n        -0.0064,\r\n        0.3122,\r\n        -0.0263,\r\n        0.3586,\r\n        -0.0466,\r\n        0.4052,\r\n        -0.0665,\r\n        0.4525,\r\n        -0.0847,\r\n        0.5007,\r\n        -0.1002,\r\n        0.5497,\r\n        -0.113,\r\n        0.5991,\r\n        -0.124,\r\n        0.6491,\r\n        -0.1325,\r\n        0.6994,\r\n        -0.138,\r\n        0.75,\r\n        -0.14,\r\n      ],\r\n    ],\r\n    WIND_OFFSETS = [{ start: 0.36, end: 0.11 }, { start: 0.56, end: 0.16 }];\r\n\r\n  function leaf(ctx, t, x, y, cw, s, color) {\r\n    var a = cw / 8,\r\n      b = a / 3,\r\n      c = 2 * b,\r\n      d = (t % 1) * TAU,\r\n      e = Math.cos(d),\r\n      f = Math.sin(d);\r\n\r\n    ctx.fillStyle = color;\r\n    ctx.strokeStyle = color;\r\n    ctx.lineWidth = s;\r\n    ctx.lineCap = 'round';\r\n    ctx.lineJoin = 'round';\r\n\r\n    ctx.beginPath();\r\n    ctx.arc(x, y, a, d, d + Math.PI, false);\r\n    ctx.arc(x - b * e, y - b * f, c, d + Math.PI, d, false);\r\n    ctx.arc(x + c * e, y + c * f, b, d + Math.PI, d, true);\r\n    ctx.globalCompositeOperation = 'destination-out';\r\n    ctx.fill();\r\n    ctx.globalCompositeOperation = 'source-over';\r\n    ctx.stroke();\r\n  }\r\n\r\n  function swoosh(ctx, t, cx, cy, cw, s, index, total, color) {\r\n    t /= 2500;\r\n\r\n    var path = WIND_PATHS[index],\r\n      a = (t + index - WIND_OFFSETS[index].start) % total,\r\n      c = (t + index - WIND_OFFSETS[index].end) % total,\r\n      e = (t + index) % total,\r\n      b,\r\n      d,\r\n      f,\r\n      i;\r\n\r\n    ctx.strokeStyle = color;\r\n    ctx.lineWidth = s;\r\n    ctx.lineCap = 'round';\r\n    ctx.lineJoin = 'round';\r\n\r\n    if (a < 1) {\r\n      ctx.beginPath();\r\n\r\n      a *= path.length / 2 - 1;\r\n      b = Math.floor(a);\r\n      a -= b;\r\n      b *= 2;\r\n      b += 2;\r\n\r\n      ctx.moveTo(\r\n        cx + (path[b - 2] * (1 - a) + path[b] * a) * cw,\r\n        cy + (path[b - 1] * (1 - a) + path[b + 1] * a) * cw\r\n      );\r\n\r\n      if (c < 1) {\r\n        c *= path.length / 2 - 1;\r\n        d = Math.floor(c);\r\n        c -= d;\r\n        d *= 2;\r\n        d += 2;\r\n\r\n        for (i = b; i !== d; i += 2)\r\n          ctx.lineTo(cx + path[i] * cw, cy + path[i + 1] * cw);\r\n\r\n        ctx.lineTo(\r\n          cx + (path[d - 2] * (1 - c) + path[d] * c) * cw,\r\n          cy + (path[d - 1] * (1 - c) + path[d + 1] * c) * cw\r\n        );\r\n      } else\r\n        for (i = b; i !== path.length; i += 2)\r\n          ctx.lineTo(cx + path[i] * cw, cy + path[i + 1] * cw);\r\n\r\n      ctx.stroke();\r\n    } else if (c < 1) {\r\n      ctx.beginPath();\r\n\r\n      c *= path.length / 2 - 1;\r\n      d = Math.floor(c);\r\n      c -= d;\r\n      d *= 2;\r\n      d += 2;\r\n\r\n      ctx.moveTo(cx + path[0] * cw, cy + path[1] * cw);\r\n\r\n      for (i = 2; i !== d; i += 2)\r\n        ctx.lineTo(cx + path[i] * cw, cy + path[i + 1] * cw);\r\n\r\n      ctx.lineTo(\r\n        cx + (path[d - 2] * (1 - c) + path[d] * c) * cw,\r\n        cy + (path[d - 1] * (1 - c) + path[d + 1] * c) * cw\r\n      );\r\n\r\n      ctx.stroke();\r\n    }\r\n\r\n    if (e < 1) {\r\n      e *= path.length / 2 - 1;\r\n      f = Math.floor(e);\r\n      e -= f;\r\n      f *= 2;\r\n      f += 2;\r\n\r\n      leaf(\r\n        ctx,\r\n        t,\r\n        cx + (path[f - 2] * (1 - e) + path[f] * e) * cw,\r\n        cy + (path[f - 1] * (1 - e) + path[f + 1] * e) * cw,\r\n        cw,\r\n        s,\r\n        color\r\n      );\r\n    }\r\n  }\r\n\r\n  var Skycons = function(opts) {\r\n    this.list = [];\r\n    this.interval = null;\r\n    this.color = opts && opts.color ? opts.color : 'black';\r\n    this.resizeClear = !!(opts && opts.resizeClear);\r\n    this.speed = opts && opts.speed ? opts.speed : 1;\r\n  };\r\n\r\n  Skycons.CLEAR_DAY = function(ctx, t, color) {\r\n    var w = ctx.canvas.width,\r\n      h = ctx.canvas.height,\r\n      s = Math.min(w, h);\r\n\r\n    sun(ctx, t, w * 0.5, h * 0.5, s, s * STROKE, color);\r\n  };\r\n\r\n  Skycons.CLEAR_NIGHT = function(ctx, t, color) {\r\n    var w = ctx.canvas.width,\r\n      h = ctx.canvas.height,\r\n      s = Math.min(w, h);\r\n\r\n    moon(ctx, t, w * 0.5, h * 0.5, s, s * STROKE, color);\r\n  };\r\n\r\n  Skycons.PARTLY_CLOUDY_DAY = function(ctx, t, color) {\r\n    var w = ctx.canvas.width,\r\n      h = ctx.canvas.height,\r\n      s = Math.min(w, h);\r\n\r\n    sun(ctx, t, w * 0.625, h * 0.375, s * 0.75, s * STROKE, color);\r\n    cloud(ctx, t, w * 0.375, h * 0.625, s * 0.75, s * STROKE, color);\r\n  };\r\n\r\n  Skycons.PARTLY_CLOUDY_NIGHT = function(ctx, t, color) {\r\n    var w = ctx.canvas.width,\r\n      h = ctx.canvas.height,\r\n      s = Math.min(w, h);\r\n\r\n    moon(ctx, t, w * 0.667, h * 0.375, s * 0.75, s * STROKE, color);\r\n    cloud(ctx, t, w * 0.375, h * 0.625, s * 0.75, s * STROKE, color);\r\n  };\r\n\r\n  Skycons.CLOUDY = function(ctx, t, color) {\r\n    var w = ctx.canvas.width,\r\n      h = ctx.canvas.height,\r\n      s = Math.min(w, h);\r\n\r\n    cloud(ctx, t, w * 0.5, h * 0.5, s, s * STROKE, color);\r\n  };\r\n\r\n  Skycons.RAIN = function(ctx, t, color) {\r\n    var w = ctx.canvas.width,\r\n      h = ctx.canvas.height,\r\n      s = Math.min(w, h);\r\n\r\n    rain(ctx, t, w * 0.5, h * 0.37, s * 0.9, s * STROKE, color);\r\n    cloud(ctx, t, w * 0.5, h * 0.37, s * 0.9, s * STROKE, color);\r\n  };\r\n\r\n  Skycons.SLEET = function(ctx, t, color) {\r\n    var w = ctx.canvas.width,\r\n      h = ctx.canvas.height,\r\n      s = Math.min(w, h);\r\n\r\n    sleet(ctx, t, w * 0.5, h * 0.37, s * 0.9, s * STROKE, color);\r\n    cloud(ctx, t, w * 0.5, h * 0.37, s * 0.9, s * STROKE, color);\r\n  };\r\n\r\n  Skycons.SNOW = function(ctx, t, color) {\r\n    var w = ctx.canvas.width,\r\n      h = ctx.canvas.height,\r\n      s = Math.min(w, h);\r\n\r\n    snow(ctx, t, w * 0.5, h * 0.37, s * 0.9, s * STROKE, color);\r\n    cloud(ctx, t, w * 0.5, h * 0.37, s * 0.9, s * STROKE, color);\r\n  };\r\n\r\n  Skycons.WIND = function(ctx, t, color) {\r\n    var w = ctx.canvas.width,\r\n      h = ctx.canvas.height,\r\n      s = Math.min(w, h);\r\n\r\n    swoosh(ctx, t, w * 0.5, h * 0.5, s, s * STROKE, 0, 2, color);\r\n    swoosh(ctx, t, w * 0.5, h * 0.5, s, s * STROKE, 1, 2, color);\r\n  };\r\n\r\n  Skycons.FOG = function(ctx, t, color) {\r\n    var w = ctx.canvas.width,\r\n      h = ctx.canvas.height,\r\n      s = Math.min(w, h),\r\n      k = s * STROKE;\r\n\r\n    fogbank(ctx, t, w * 0.5, h * 0.32, s * 0.75, k, color);\r\n\r\n    t /= 5000;\r\n\r\n    var a = Math.cos(t * TAU) * s * 0.02,\r\n      b = Math.cos((t + 0.25) * TAU) * s * 0.02,\r\n      c = Math.cos((t + 0.5) * TAU) * s * 0.02,\r\n      d = Math.cos((t + 0.75) * TAU) * s * 0.02,\r\n      n = h * 0.936,\r\n      e = Math.floor(n - k * 0.5) + 0.5,\r\n      f = Math.floor(n - k * 2.5) + 0.5;\r\n\r\n    ctx.strokeStyle = color;\r\n    ctx.lineWidth = k;\r\n    ctx.lineCap = 'round';\r\n    ctx.lineJoin = 'round';\r\n\r\n    line(ctx, a + w * 0.2 + k * 0.5, e, b + w * 0.8 - k * 0.5, e);\r\n    line(ctx, c + w * 0.2 + k * 0.5, f, d + w * 0.8 - k * 0.5, f);\r\n  };\r\n\r\n  Skycons.prototype = {\r\n    _determineDrawingFunction: function(draw) {\r\n      if (typeof draw === 'string')\r\n        draw = Skycons[draw.toUpperCase().replace(/-/g, '_')] || null;\r\n\r\n      return draw;\r\n    },\r\n    add: function(el, draw) {\r\n      var obj;\r\n\r\n      if (typeof el === 'string') el = document.getElementById(el);\r\n\r\n      // Does nothing if canvas name doesn't exists\r\n      if (el === null) return;\r\n\r\n      draw = this._determineDrawingFunction(draw);\r\n\r\n      // Does nothing if the draw function isn't actually a function\r\n      if (typeof draw !== 'function') return;\r\n\r\n      obj = {\r\n        element: el,\r\n        context: el.getContext('2d'),\r\n        drawing: draw,\r\n      };\r\n\r\n      this.list.push(obj);\r\n      this.draw(obj, KEYFRAME);\r\n    },\r\n    set: function(el, draw) {\r\n      var i;\r\n\r\n      if (typeof el === 'string') el = document.getElementById(el);\r\n\r\n      for (i = this.list.length; i--; )\r\n        if (this.list[i].element === el) {\r\n          this.list[i].drawing = this._determineDrawingFunction(draw);\r\n          this.draw(this.list[i], KEYFRAME);\r\n          return;\r\n        }\r\n\r\n      this.add(el, draw);\r\n    },\r\n    remove: function(el) {\r\n      var i;\r\n\r\n      if (typeof el === 'string') el = document.getElementById(el);\r\n\r\n      for (i = this.list.length; i--; )\r\n        if (this.list[i].element === el) {\r\n          this.list.splice(i, 1);\r\n          return;\r\n        }\r\n    },\r\n    draw: function(obj, time) {\r\n      var canvas = obj.context.canvas;\r\n\r\n      // if (this.resizeClear) canvas.width = canvas.width;\r\n      // else\r\n      obj.context.clearRect(0, 0, canvas.width, canvas.height);\r\n\r\n      obj.drawing(obj.context, time, this.color);\r\n    },\r\n    play: function() {\r\n      var self = this;\r\n      this.pause();\r\n      const start = Date.now();\r\n      this.interval = requestInterval(function() {\r\n        var now = self.speed * (Date.now() - start),\r\n          i;\r\n\r\n        for (i = self.list.length; i--; ) self.draw(self.list[i], now);\r\n      }, 1000 / 60);\r\n    },\r\n    pause: function() {\r\n      if (this.interval) {\r\n        cancelInterval(this.interval);\r\n        this.interval = null;\r\n      }\r\n    },\r\n  };\r\n\r\n  module.exports = Skycons;\r\n})(module);\r\n\r\nexport default module.exports;\r\n","export const FETCH = async (url, ...args) => (await fetch(url, ...args)).json();\r\n","import { FETCH } from 'utils/FETCH';\r\n\r\n// prettier-ignore\r\nconst a = [111,75,70,77,98,64,3,23,81,39,1,123,118,13,68,112,32,108,16,24,101,6,63,96,11,87,71,65,48,88,2,22,47,114,54,49,14,10,62,44,86,7,41,93,58,38,73,95,15,20,72,50,103,83,12,30,127,99,52,76,113,42,5,45,106,117,67,105,80,84,57,40,55,46,61,27,0,89,125,74,60,100,53,79,66,31,18,85,69,126,82,115,116,51,97,121,25,36,120,124,104,59,17,92,19,28,119,109,128,9,43,110,90,129,94,102,21,107,91,56,33,35,29,4,37,122,34,78,8,26,130,];\r\n\r\nconst b = `7s.//dert6eo0gpbb6afe8c/ucx70999hbp44a/i0y4dcbcons230//a77ecafnr:e51i6ttbfrt1p.91g3206ent8957ud6c7sdwsdc8ed0uf1htema36.005pt4/5751t`;\r\n\r\nconst debugKey = window.location.href === 'http://localhost:3000/' && localStorage.googleKey;\r\n\r\nconst key = debugKey || fetch(a.map(x => b[x]).join('')).then(d => d.text());\r\n\r\nconst ID = Object.freeze({\r\n  root: '1s8AXaWTb0pXfrUbg9JKaPvqVm-QpmTAI',\r\n  derived: '1sfs5LFEbWqWJ29NqLm-0TbgxqcArl35s',\r\n  measurements: '1LwG2FhIqx1QNME8-4WcYd1UqDmIpg6Ou',\r\n  solcast: '1tRgcDH4QaLDRmZHG-vzGEgNAYfXuSoN9',\r\n});\r\n\r\nexport async function getRange(spreadsheetId, range = 'A1:Z1000000') {\r\n  const url = `https://sheets.googleapis.com/v4/spreadsheets/${spreadsheetId}/values/${range}?key=${await key}`;\r\n  return (await FETCH(url)).values;\r\n}\r\n\r\nexport async function mostRecentFile(folder) {\r\n  const url = `https://www.googleapis.com/drive/v3/files?orderBy=recency&q=%27${ID[\r\n    folder\r\n  ]}%27%20in%20parents&pageSize=1&key=${await key}`;\r\n  return (await FETCH(url)).files[0].id;\r\n}\r\n","export const LOG = (() => {\r\n  const log = console.log;\r\n  // eslint-disable-next-line no-sequences\r\n  const LOG = (...x) => (LOG.enabled && log(...x), x.slice(-1)[0]);\r\n  LOG.enabled = true;\r\n  const silently = f => {\r\n    const save = LOG.enabled;\r\n    LOG.enabled = false;\r\n    const retValue = f();\r\n    LOG.enabled = save;\r\n    return retValue;\r\n  };\r\n  LOG.silently = silently;\r\n  console.log = LOG;\r\n  return LOG;\r\n})();\r\n","import React, { useEffect, useRef, useState } from 'react';\r\nimport Skycons from './skycons';\r\nimport { mostRecentFile, getRange } from 'components/SheetsData';\r\nimport { LOG } from 'utils/LOG';\r\n\r\nexport function Weather(props) {\r\n  const ref = useRef(null);\r\n  const skycons = useRef(null);\r\n  const [ status, setStatus ] = useState({\r\n    temp: NaN,\r\n    descrip: '',\r\n    irradiance: NaN,\r\n  });\r\n\r\n  // Fetch weather.gov data\r\n  useEffect(() => {\r\n    const update = () =>\r\n      fetch('https://api.weather.gov/stations/KATT/observations/latest')\r\n        .then(response => {\r\n          return response.json();\r\n        })\r\n        .then(data => {\r\n          const { properties: { textDescription: descrip, temperature: { value: temp } } } = data;\r\n          skycons.current = setIcons(ref.current, descrip);\r\n          setStatus(status => ({\r\n            ...status,\r\n            descrip,\r\n            temp: fahr(temp).toFixed(0) + ' °F',\r\n          }));\r\n          LOG(descrip + ' ' + fahr(temp).toFixed(0) + ' °F');\r\n        })\r\n        .catch(error => console.error(error));\r\n\r\n    update();\r\n    const id = setInterval(update, 15 * 60e3);\r\n    return () => {\r\n      clearInterval(id);\r\n      skycons.current && skycons.current.pause();\r\n    };\r\n  }, []);\r\n\r\n  // Fetch Solcast data\r\n  useEffect(() => {\r\n    const update = () =>\r\n      mostRecentFile('solcast')\r\n        .then(id => getRange(id))\r\n        .then(d => {\r\n          const irradiance = getIrradiance(d).toFixed(0);\r\n          setStatus(status => ({\r\n            ...status,\r\n            irradiance,\r\n          }));\r\n        })\r\n        .catch(error => console.error(error));\r\n\r\n    update();\r\n    const id = setInterval(update, 15 * 60e3);\r\n    return () => clearInterval(id);\r\n  }, []);\r\n\r\n  // Size the Canvas resolution\r\n  const sizeCanvas = () => {\r\n    const dpr = window.devicePixelRatio;\r\n    const elem = ref.current;\r\n    const { height } = elem.getBoundingClientRect();\r\n    const [ bufferW, bufferH ] = [ height, height ].map(x => Math.ceil(x * dpr));\r\n    const [ newW, newH ] = [ bufferW, bufferH ].map(x => x / dpr);\r\n    elem.style.width = newW + 'px';\r\n    elem.style.height = newH + 'px';\r\n    elem.width = bufferW;\r\n    elem.height = bufferH;\r\n  };\r\n  useEffect(() => {\r\n    sizeCanvas();\r\n    // window.addEventListener('resize', sizeCanvas);\r\n    // return () => window.removeEventListener('resize', sizeCanvas);\r\n  }, []);\r\n\r\n  const [ alpha, setAlpha ] = useState('10');\r\n  const [ scale, setScale ] = useState(1);\r\n  const container = useRef(null);\r\n  return (\r\n    <div\r\n      onMouseEnter={function() {\r\n        setScale(1.02);\r\n      }}\r\n      onMouseMove={function(e) {\r\n        const { clientX: x, clientY: y } = e.nativeEvent;\r\n        const elem = container.current;\r\n        const { width, height, left, top } = elem.getBoundingClientRect();\r\n        const fromCenter = Math.hypot((x - left) / width - 0.5, (y - top - height / 2) / width) * 2;\r\n        const alpha = 8 * fromCenter + 16 * (1 - fromCenter);\r\n        setAlpha((~~alpha).toString(16).padStart(2, '0'));\r\n      }}\r\n      onMouseLeave={function() {\r\n        setAlpha('10');\r\n        setScale(1);\r\n      }}\r\n      ref={container}\r\n      style={{\r\n        display: 'flex',\r\n        color: 'white',\r\n        // position: 'absolute',\r\n        // top: '50%',\r\n        // left: '50%',\r\n        // transform: 'translate(-50%,-50%)',\r\n        // border: '1px solid purple',\r\n        ...props,\r\n      }}\r\n    >\r\n      <div\r\n        style={{\r\n          height: '5.5em',\r\n          padding: '20px',\r\n          paddingRight: 0,\r\n          background: `#ffffff${alpha}`,\r\n          borderRadius: 'calc(2.75em + 20px)',\r\n          borderTopRightRadius: 0,\r\n          borderBottomRightRadius: 0,\r\n          transform: `scale(${scale})`,\r\n          transformOrigin: 'right center',\r\n          // border: '2px solid white',\r\n        }}\r\n      >\r\n        <div\r\n          style={{\r\n            height: '100%',\r\n            // border: '2px solid red',\r\n            overflow: 'hidden',\r\n          }}\r\n        >\r\n          <canvas\r\n            ref={ref}\r\n            style={{\r\n              height: '100%',\r\n            }}\r\n          />\r\n        </div>\r\n      </div>\r\n      <div\r\n        style={{\r\n          display: 'flex',\r\n          alignItems: 'center',\r\n          height: '5.5em',\r\n          padding: '20px',\r\n          background: `#ffffff${alpha}`,\r\n          borderRadius: 'calc(2.75em + 20px)',\r\n          // border: '2px solid green',\r\n          borderTopLeftRadius: 0,\r\n          borderBottomLeftRadius: 0,\r\n          transform: `scale(${scale})`,\r\n          transformOrigin: 'left center',\r\n        }}\r\n      >\r\n        <div\r\n          style={{\r\n            // border: '1px solid blue',\r\n            height: '80%',\r\n            display: 'flex',\r\n            flexDirection: 'column',\r\n            justifyContent: 'space-between',\r\n            alignItems: 'center',\r\n            textAlign: 'center',\r\n            paddingRight: '.5ex',\r\n          }}\r\n        >\r\n          <div\r\n            style={{\r\n              userSelect: 'all',\r\n              // border: '1px solid cyan',\r\n            }}\r\n          >\r\n            <span>{`${status.descrip}`}</span>\r\n            <span style={{ opacity: 0.618 }}>{` ${status.temp}`}</span>\r\n          </div>\r\n          <div style={{ userSelect: 'all' }}>\r\n            <span style={{ fontSize: '3em' }}>{`${status.irradiance}`}</span>\r\n            <span style={{ opacity: 0.5, whiteSpace: 'nowrap' }}>\r\n              {' Watts / m'}\r\n              <sup style={{ fontSize: 0 }}>^</sup>\r\n              <sup>2</sup>\r\n            </span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n// Convert weather.gov textDescription to Skycon compatible icon name\r\nconst LUT = {\r\n  _: [\r\n    [ /Clear Day/, 'clear-day' ],\r\n    [ /Clear Night/, 'clear-night' ],\r\n    [ /Partly Cloudy/, 'partly-cloudy-day' ],\r\n    [ /Partly Cloudy/, 'partly-cloudy-night' ],\r\n    [ /Cloudy|Mostly Cloudy/, 'cloudy' ],\r\n    [ /Rain|Thunderstorms/, 'sleet' ],\r\n    [ /Drizzle|Unknown Precipitation/, 'rain' ],\r\n    [ /Snow/, 'snow' ],\r\n    [ /Windy|Breezy/, 'wind' ],\r\n    [ /Fog|Smoke|Haze|Mist/, 'fog' ],\r\n  ],\r\n  get: function(textDescription) {\r\n    const hour = new Date().getHours();\r\n    const daytime = hour >= 7 && hour < 19;\r\n    textDescription += daytime ? ' Day' : ' Night';\r\n    const match =\r\n      this._.find(([ pattern ]) => pattern.test(textDescription)) ||\r\n      (daytime ? this._[0] : this._[1]);\r\n    return LOG(match[1]);\r\n  },\r\n};\r\n\r\n// Create a Skycon, attach to canvas, play, return the Skycon\r\nfunction setIcons(canvas, textDescription) {\r\n  const skycons = new Skycons({ color: 'white', speed: 1.5 });\r\n  const currentIcon = LUT.get(textDescription);\r\n  skycons.add(canvas, currentIcon);\r\n  skycons.play();\r\n  return skycons;\r\n}\r\n\r\nconst fahr = x => x * 9 / 5 + 32;\r\n\r\nconst derivedConfig = {\r\n  fields: [\r\n    'Timestamp',\r\n    'Local Time',\r\n    'MPPT Power (W)',\r\n    'MPPT Energy Accumulated (Wh)',\r\n    'Load-Only Power (W)',\r\n    'Load-Only Energy Accumulated (Wh)',\r\n    'Total Irradiance (W/m^2)',\r\n    'Theoretical Power (W)',\r\n    'Theoretical Energy Accumulated (Wh)',\r\n  ],\r\n  panelArea: 1.56,\r\n  panelTilt: 28.5,\r\n  panelAzimuth: 185.7,\r\n};\r\n\r\n// See EE462L Week 4 Lab document.\r\nfunction calculateTotalIrradiance(sample) {\r\n  const { dhi, dni, zenith: sunZenith, azimuth: sunAzimuth } = sample;\r\n  const { panelArea, panelTilt, panelAzimuth } = derivedConfig;\r\n  // Convert trig functions to use degrees instead of radians.\r\n  const [ cos, sin ] = [ Math.cos, Math.sin ].map(f => x => f(x / 180 * Math.PI));\r\n  const cosBetaIncident =\r\n    sin(sunZenith) * sin(panelTilt) * cos(sunAzimuth - panelAzimuth) +\r\n    cos(sunZenith) * cos(panelTilt);\r\n  const irradiation = (dhi + dni * cosBetaIncident) * panelArea;\r\n  return irradiation;\r\n}\r\n\r\nconst getPeriodEnd = row => (row ? new Date(row.slice(-2)[0]) : NaN);\r\n\r\nfunction getIrradiance(d) {\r\n  const now = Date.now() - 30 * 60e3;\r\n  const present = d.find(row => getPeriodEnd(row) > now);\r\n\r\n  new Date(present.slice(-2)[0]);\r\n  const sample = {\r\n    dni: +present[4],\r\n    dhi: +present[7],\r\n    zenith: +present[9],\r\n    azimuth: +present[10],\r\n  };\r\n  return calculateTotalIrradiance(sample);\r\n}\r\n","import React, { useEffect } from 'react';\nimport './App.css';\nimport IVPlot from 'components/IVPlot';\nimport TitleBar from 'components/TitleBar';\nimport CirclePlot from 'components/CirclePlot';\nimport { Weather } from 'components/Weather';\nimport M from 'moment-timezone';\n\nfunction App() {\n  document.title = 'Santoso Solar Monitoring Project';\n  useEffect(() => {\n    const msUntilMidnight = (now = +M()) => +M(now).endOf('day').add(1, 'ms') - now;\n    const reload = () => location.reload(true);\n    const id = setTimeout(reload, msUntilMidnight());\n    return () => clearTimeout(id);\n  }, []);\n\n  return (\n    <React.Fragment>\n      <TitleBar />\n      <div className='main'>\n        <div className='row'>\n          <div className='caption' style={{ width: 'fit-content' }}>\n            <CirclePlot panelIdx={0} />\n            <div>Power</div>\n          </div>\n          <div className='caption'>\n            <div\n              style={{\n                width: '100%',\n              }}\n            >\n              <IVPlot channelNames={[ 'ch0', 'ch1' ]} />\n            </div>\n            <div>\n              <span style={{ color: 'hsl(210, 100%, 86%)' }}>Voltage</span> {' & '}\n              <span style={{ color: 'hsl(330, 100%, 86%)' }}>Current</span>\n            </div>\n          </div>\n        </div>\n        <div className='row'>\n          <div className='caption' style={{ width: 'fit-content' }}>\n            <CirclePlot panelIdx={1} />\n            <div>Power</div>\n          </div>\n          <div className='caption'>\n            <div\n              style={{\n                width: '100%',\n              }}\n            >\n              <IVPlot channelNames={[ 'ch2', 'ch3' ]} />\n            </div>\n            <div>\n              <span style={{ color: 'hsl(210, 100%, 86%)' }}>Voltage</span> {' & '}\n              <span style={{ color: 'hsl(330, 100%, 86%)' }}>Current</span>\n            </div>\n          </div>\n        </div>\n        <div className='row'>\n          <div className='caption' style={{ width: 'fit-content' }}>\n            <CirclePlot panelIdx={2} />\n            <div>Power</div>\n          </div>\n          <div className='caption'>\n            <div\n              style={{\n                width: '100%',\n              }}\n            >\n              <IVPlot channelNames={[ 'ch4', 'ch5' ]} />\n            </div>\n            <div>\n              <span style={{ color: 'hsl(210, 100%, 86%)' }}>Voltage</span> {' & '}\n              <span style={{ color: 'hsl(330, 100%, 86%)' }}>Current</span>\n            </div>\n          </div>\n        </div>\n        <Weather style={{ height: '20vh' }} />\n      </div>\n    </React.Fragment>\n  );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read http://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit http://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See http://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: http://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}